/*
속도 개선을 위하여 TRUNCATE TABLE 로 변경합니다. by mkim 20160219
*/

/* 송신_수출(정정)신고서 공통사항 */
TRUNCATE TABLE BFEXPO1;

INSERT INTO BFEXPO1 ( EXPO_KEY, EXPO_SEQNO, EXPO_YEAR, EXPO_JECHLNO, EXPO_CHK_DG, EXPO_SAVE_GBN, EXPO_LOCAL_GUBUN, EXPO_GEYAK_NO1, EXPO_GEYAK_NO2, 
                      EXPO_TCANO, EXPO_JIYEK_GBN, EXPO_SINGOJA_SANGHO, EXPO_SUCHULJA_CODE, EXPO_SUCHULJA_SANGHO, EXPO_SUCHULJA_BUHO, EXPO_SUCHULJA_GBN, 
					  EXPO_WHAJU_CODE, EXPO_WHAJU_SANGHO, EXPO_WHAJU_JUSO, EXPO_WHAJU_NAME, EXPO_WHAJU_TONG, EXPO_WHAJU_SAUP_GBN, EXPO_WHAJU_SAUP, 
					  EXPO_GUMAEJA_CODE, EXPO_GUMAEJA_SANGHO, EXPO_GUMAEJA_NATION, EXPO_WHAN_SIN, EXPO_WHAN_BUHO, EXPO_WHAN_GIGWAN, EXPO_SEGWAN, 
					  EXPO_GWA, EXPO_SINGO_YEAR, EXPO_SINGO_NO, EXPO_SINGO_DG, EXPO_SINGO_DATE, EXPO_SINGO_GBN, EXPO_GUMSA_GBN, EXPO_GURAE_GBN, EXPO_JONG, 
					  EXPO_GYELJE, EXPO_MOKJUK_CODE, EXPO_MOKJUK_NAME, EXPO_HANGGU_CODE, EXPO_HANGGU_NAME, EXPO_UNSONG_TYPE, EXPO_UNSONG_BOX, EXPO_JEJO_DATE, 
					  EXPO_POST, EXPO_JUSO, EXPO_LC_NO, EXPO_IV_NO, EXPO_CHAMJO_NO, EXPO_LAN, EXPO_TOTAL_JUNG, EXPO_JUNG_DANWI, EXPO_POJANG_SU, EXPO_USD_EXCH, 
					  EXPO_TOTAL_WON, EXPO_TOTAL_USD, EXPO_INDOJO, EXPO_GYELJE_MONEY, EXPO_GYELJE_EXCH, EXPO_GYELJE_INPUT, EXPO_CALC_YN, EXPO_FRE_MONEY, 
					  EXPO_FRE_EXCH, EXPO_FRE_INPUT, EXPO_FRE_CALC, EXPO_INS_MONEY, EXPO_INS_EXCH, EXPO_INS_INPUT, EXPO_INS_CALC, EXPO_ETC_MONEY, EXPO_ETC_EXCH, 
					  EXPO_ETC_INPUT, EXPO_ETC_GUM, EXPO_SEUNG_NO, EXPO_SEUNG_CH_DATE, EXPO_SEUNG_DATE, EXPO_SAYU, EXPO_CHUCHEON_NO, EXPO_CHUCHEON_DATE, 
					  EXPO_GUMSA_NO, EXPO_GUMSA_DATE, EXPO_GUMYEOK_NO, EXPO_GUMYEOK_DATE, EXPO_JUNLYK_NO, EXPO_JUNLYK_DATE, EXPO_UNSONG_CODE, EXPO_UNSONG_SANGHO, 
					  EXPO_UNSONG_DATE1, EXPO_UNSONG_DATE2, EXPO_RES_TYPE, EXPO_SEND_GBN, EXPO_GIJELAN, EXPO_OK_DATE, EXPO_OK_NO, EXPO_JUNSONG_RESULT, EXPO_RES_RESULT, 
					  EXPO_ACCCNV, EXPO_DAMDANGJA, EXPO_JANGCHI_CNT, EXPO_WEBSERVER, EXPO_DAECODE, EXPO_DAESANGHO, EXPO_DAESAUPNO, EXPO_SUCHULSAUPNO, EXPO_SUCHUL_UPTE, 
					  EXPO_SUCHUL_JONGMOK, EXPO_WHAJU_UPTE, EXPO_WHAJU_JONGMOK, LOG_TYPE, EVENT_TYPE, EXPO_IMSIGAE_YN, EXPO_BANSONG_SAYU, EXPO_MRN_BUNHAL, EXPO_SUNJUK_DATE, 
					  EXPO_TCA_SILJUK, EXPO_OLD_YN, FAX_SEND, EXPO_TRUST_CODE, EXPO_TRUST_SANGHO, EXPO_TRUST_JUSO, EXPO_TRUST_NAME, EXPO_TRUST_TONG, EXPO_TRUST_SAUP, 
					  EXPO_TRUST_SAUP_GBN, EXPO_TRUST_GUBUN, SCAN_LINK, EXPO_WHAN_GAN2, EXPO_INDUSTRY, EXPO_HOW_CHECK, EXPO_POJANG_DANWI, EXPO_SINGOJA_GIJE, 
					  EXPO_SINGOJA_NAME, EXPO_JUKIP_YN, EXPO_JUNG_CD2, USERNO, FORWARD_CODE, FORWARD_SANGHO, EXPO_ENG_ADDRESS, EXPO_LEAVE_DAY, EXPO_SOUTHNORTHTRADEYN, 
					  EXPO_UCR, EXPO_SUCHULJA_TONG, EXPO_TRUST_POST, MAIL_SEND, SMSSEND, USERID, USERNM, ADDDTTIME, EDITDTTIME, EXPO_PRELOADAREACD, EXPO_PRESTARTDT, 
					  EXPO_SHIPAIRCOMCD, EXPO_SHIPAIRCOMNM, EXPO_SHIPAIRNM, EXPO_LOADED_YN, EXPO_SEBUHO, EXPO_SEDMDNGNM, ATTACHIMAGEYN, EXPO_JANGCHI_CODE, EXPO_BANIP_NO, 
					  EXPO_LOADEDDT, SENDERNM, BFLOADCHK )
SELECT EXPO_KEY, ROW_NUM, EXPO_YEAR, EXPO_JECHLNO, EXPO_CHK_DG, EXPO_SAVE_GBN, EXPO_LOCAL_GUBUN, EXPO_GEYAK_NO1, EXPO_GEYAK_NO2, 
       EXPO_TCANO, EXPO_JIYEK_GBN, EXPO_SINGOJA_SANGHO, EXPO_SUCHULJA_CODE, EXPO_SUCHULJA_SANGHO, EXPO_SUCHULJA_BUHO, EXPO_SUCHULJA_GBN, 
	   EXPO_WHAJU_CODE, EXPO_WHAJU_SANGHO, EXPO_WHAJU_JUSO, EXPO_WHAJU_NAME, EXPO_WHAJU_TONG, EXPO_WHAJU_SAUP_GBN, EXPO_WHAJU_SAUP, 
	   EXPO_GUMAEJA_CODE, EXPO_GUMAEJA_SANGHO, EXPO_GUMAEJA_NATION, EXPO_WHAN_SIN, EXPO_WHAN_BUHO, EXPO_WHAN_GIGWAN, EXPO_SEGWAN, 
	   EXPO_GWA, EXPO_SINGO_YEAR, EXPO_SINGO_NO, EXPO_SINGO_DG, EXPO_SINGO_DATE, EXPO_SINGO_GBN, EXPO_GUMSA_GBN, EXPO_GURAE_GBN, EXPO_JONG, 
	   EXPO_GYELJE, EXPO_MOKJUK_CODE, EXPO_MOKJUK_NAME, EXPO_HANGGU_CODE, EXPO_HANGGU_NAME, EXPO_UNSONG_TYPE, EXPO_UNSONG_BOX, EXPO_JEJO_DATE, 
	   EXPO_POST, EXPO_JUSO, EXPO_LC_NO, EXPO_IV_NO, EXPO_CHAMJO_NO, EXPO_LAN, EXPO_TOTAL_JUNG, EXPO_JUNG_DANWI, EXPO_POJANG_SU, EXPO_USD_EXCH, 
	   EXPO_TOTAL_WON, EXPO_TOTAL_USD, EXPO_INDOJO, EXPO_GYELJE_MONEY, EXPO_GYELJE_EXCH, EXPO_GYELJE_INPUT, EXPO_CALC_YN, EXPO_FRE_MONEY, 
	   EXPO_FRE_EXCH, EXPO_FRE_INPUT, EXPO_FRE_CALC, EXPO_INS_MONEY, EXPO_INS_EXCH, EXPO_INS_INPUT, EXPO_INS_CALC, EXPO_ETC_MONEY, EXPO_ETC_EXCH, 
	   EXPO_ETC_INPUT, EXPO_ETC_GUM, EXPO_SEUNG_NO, EXPO_SEUNG_CH_DATE, EXPO_SEUNG_DATE, EXPO_SAYU, EXPO_CHUCHEON_NO, EXPO_CHUCHEON_DATE, 
	   EXPO_GUMSA_NO, EXPO_GUMSA_DATE, EXPO_GUMYEOK_NO, EXPO_GUMYEOK_DATE, EXPO_JUNLYK_NO, EXPO_JUNLYK_DATE, EXPO_UNSONG_CODE, EXPO_UNSONG_SANGHO, 
	   EXPO_UNSONG_DATE1, EXPO_UNSONG_DATE2, EXPO_RES_TYPE, EXPO_SEND_GBN, EXPO_GIJELAN, EXPO_OK_DATE, EXPO_OK_NO, EXPO_JUNSONG_RESULT, EXPO_RES_RESULT, 
	   EXPO_ACCCNV, EXPO_DAMDANGJA, EXPO_JANGCHI_CNT, EXPO_WEBSERVER, EXPO_DAECODE, EXPO_DAESANGHO, EXPO_DAESAUPNO, EXPO_SUCHULSAUPNO, EXPO_SUCHUL_UPTE, 
	   EXPO_SUCHUL_JONGMOK, EXPO_WHAJU_UPTE, EXPO_WHAJU_JONGMOK, LOG_TYPE, EVENT_TYPE, EXPO_IMSIGAE_YN, EXPO_BANSONG_SAYU, EXPO_MRN_BUNHAL, EXPO_SUNJUK_DATE, 
	   EXPO_TCA_SILJUK, EXPO_OLD_YN, FAX_SEND, EXPO_TRUST_CODE, EXPO_TRUST_SANGHO, EXPO_TRUST_JUSO, EXPO_TRUST_NAME, EXPO_TRUST_TONG, EXPO_TRUST_SAUP, 
	   EXPO_TRUST_SAUP_GBN, EXPO_TRUST_GUBUN, SCAN_LINK, EXPO_WHAN_GAN2, EXPO_INDUSTRY, EXPO_HOW_CHECK, EXPO_POJANG_DANWI, EXPO_SINGOJA_GIJE, 
	   EXPO_SINGOJA_NAME, EXPO_JUKIP_YN, EXPO_JUNG_CD2, USERNO, FORWARD_CODE, FORWARD_SANGHO, EXPO_ENG_ADDRESS, EXPO_LEAVE_DAY, EXPO_SOUTHNORTHTRADEYN, 
	   EXPO_UCR, EXPO_SUCHULJA_TONG, EXPO_TRUST_POST, MAIL_SEND, SMSSEND, USERID, USERNM, ADDDTTIME, EDITDTTIME, EXPO_PRELOADAREACD, EXPO_PRESTARTDT, 
	   EXPO_SHIPAIRCOMCD, EXPO_SHIPAIRCOMNM, EXPO_SHIPAIRNM, EXPO_LOADED_YN, EXPO_SEBUHO, EXPO_SEDMDNGNM, ATTACHIMAGEYN, EXPO_JANGCHI_CODE, EXPO_BANIP_NO, 
	   EXPO_LOADEDDT, SENDERNM, BFLOADCHK
FROM ( SELECT DENSE_RANK() OVER (PARTITION BY EXPO_KEY ORDER BY EXPO_JUNG_CD ASC)  AS ROW_NUM,
              EXPO_KEY, EXPO_YEAR, EXPO_JECHLNO, EXPO_CHK_DG, EXPO_SAVE_GBN, EXPO_LOCAL_GUBUN, EXPO_GEYAK_NO1, EXPO_GEYAK_NO2, 
			  EXPO_TCANO, EXPO_JIYEK_GBN, EXPO_SINGOJA_SANGHO, EXPO_SUCHULJA_CODE, EXPO_SUCHULJA_SANGHO, EXPO_SUCHULJA_BUHO, EXPO_SUCHULJA_GBN, 
			  EXPO_WHAJU_CODE, EXPO_WHAJU_SANGHO, EXPO_WHAJU_JUSO, EXPO_WHAJU_NAME, EXPO_WHAJU_TONG, EXPO_WHAJU_SAUP_GBN, EXPO_WHAJU_SAUP, 
			  EXPO_GUMAEJA_CODE, EXPO_GUMAEJA_SANGHO, EXPO_GUMAEJA_NATION, EXPO_WHAN_SIN, EXPO_WHAN_BUHO, EXPO_WHAN_GIGWAN, EXPO_SEGWAN, 
			  EXPO_GWA, EXPO_SINGO_YEAR, EXPO_SINGO_NO, EXPO_SINGO_DG, EXPO_SINGO_DATE, EXPO_SINGO_GBN, EXPO_GUMSA_GBN, EXPO_GURAE_GBN, EXPO_JONG, 
			  EXPO_GYELJE, EXPO_MOKJUK_CODE, EXPO_MOKJUK_NAME, EXPO_HANGGU_CODE, EXPO_HANGGU_NAME, EXPO_UNSONG_TYPE, EXPO_UNSONG_BOX, EXPO_JEJO_DATE, 
			  EXPO_POST, EXPO_JUSO, EXPO_LC_NO, EXPO_IV_NO, EXPO_CHAMJO_NO, EXPO_LAN, EXPO_TOTAL_JUNG, EXPO_JUNG_DANWI, EXPO_POJANG_SU, EXPO_USD_EXCH, 
			  EXPO_TOTAL_WON, EXPO_TOTAL_USD, EXPO_INDOJO, EXPO_GYELJE_MONEY, EXPO_GYELJE_EXCH, EXPO_GYELJE_INPUT, EXPO_CALC_YN, EXPO_FRE_MONEY, 
			  EXPO_FRE_EXCH, EXPO_FRE_INPUT, EXPO_FRE_CALC, EXPO_INS_MONEY, EXPO_INS_EXCH, EXPO_INS_INPUT, EXPO_INS_CALC, EXPO_ETC_MONEY, EXPO_ETC_EXCH, 
			  EXPO_ETC_INPUT, EXPO_ETC_GUM, EXPO_SEUNG_NO, EXPO_SEUNG_CH_DATE, EXPO_SEUNG_DATE, EXPO_SAYU, EXPO_CHUCHEON_NO, EXPO_CHUCHEON_DATE, 
			  EXPO_GUMSA_NO, EXPO_GUMSA_DATE, EXPO_GUMYEOK_NO, EXPO_GUMYEOK_DATE, EXPO_JUNLYK_NO, EXPO_JUNLYK_DATE, EXPO_UNSONG_CODE, EXPO_UNSONG_SANGHO, 
			  EXPO_UNSONG_DATE1, EXPO_UNSONG_DATE2, EXPO_RES_TYPE, EXPO_SEND_GBN, EXPO_GIJELAN, EXPO_OK_DATE, EXPO_OK_NO, EXPO_JUNSONG_RESULT, EXPO_RES_RESULT, 
			  EXPO_ACCCNV, EXPO_DAMDANGJA, EXPO_JANGCHI_CNT, EXPO_WEBSERVER, EXPO_DAECODE, EXPO_DAESANGHO, EXPO_DAESAUPNO, EXPO_SUCHULSAUPNO, EXPO_SUCHUL_UPTE, 
			  EXPO_SUCHUL_JONGMOK, EXPO_WHAJU_UPTE, EXPO_WHAJU_JONGMOK, LOG_TYPE, EVENT_TYPE, EXPO_IMSIGAE_YN, EXPO_BANSONG_SAYU, EXPO_MRN_BUNHAL, EXPO_SUNJUK_DATE, 
			  EXPO_TCA_SILJUK, EXPO_OLD_YN, FAX_SEND, EXPO_TRUST_CODE, EXPO_TRUST_SANGHO, EXPO_TRUST_JUSO, EXPO_TRUST_NAME, EXPO_TRUST_TONG, EXPO_TRUST_SAUP, 
			  EXPO_TRUST_SAUP_GBN, EXPO_TRUST_GUBUN, SCAN_LINK, EXPO_WHAN_GAN2, EXPO_INDUSTRY, EXPO_HOW_CHECK, EXPO_POJANG_DANWI, EXPO_SINGOJA_GIJE, 
			  EXPO_SINGOJA_NAME, EXPO_JUKIP_YN, EXPO_JUNG_CD2, USERNO, FORWARD_CODE, FORWARD_SANGHO, EXPO_ENG_ADDRESS, EXPO_LEAVE_DAY, EXPO_SOUTHNORTHTRADEYN, 
			  EXPO_UCR, EXPO_SUCHULJA_TONG, EXPO_TRUST_POST, MAIL_SEND, SMSSEND, USERID, USERNM, ADDDTTIME, EDITDTTIME, EXPO_PRELOADAREACD, EXPO_PRESTARTDT, 
			  EXPO_SHIPAIRCOMCD, EXPO_SHIPAIRCOMNM, EXPO_SHIPAIRNM, EXPO_LOADED_YN, EXPO_SEBUHO, EXPO_SEDMDNGNM, ATTACHIMAGEYN, EXPO_JANGCHI_CODE, EXPO_BANIP_NO, 
			  EXPO_LOADEDDT, SENDERNM, BFLOADCHK
       FROM KCBA.DBO.BFEXPO1 ) A;



/* 송신_수출(정정)신고서 란사항 */
TRUNCATE TABLE BFEXPO2;

INSERT INTO BFEXPO2 ( EXLAN_KEY, EXLAN_SEQNO, EXLAN_LAN, EXLAN_JUNG_GUBUN, EXLAN_HS, EXLAN_JEPUM_CODE, EXLAN_JUNG, EXLAN_JUNG_DANWI, EXLAN_SU, EXLAN_SU_DANWI, 
                      EXLAN_POJANG_SU, EXLAN_POJANG_DANWI, EXLAN_WHAN_JEPUM, EXLAN_HNAME, EXLAN_ENAME, EXLAN_EGUKYK, EXLAN_PUM1, EXLAN_GUKYK, EXLAN_GYELJE_GUM, 
					  EXLAN_GYELJE_FOB, EXLAN_FOB_WON, EXLAN_FOB_USD, EXLAN_IMPOSINGONO, EXLAN_IMPOLANNO, EXLAN_ATTACH_YN, EXLAN_SANGPYO, EXLAN_WONSANJI, 
					  EXLAN_WONSANJI_BANG, EXLAN_WONSANJI_PYOSI, EXLAN_COISSUEYN )
SELECT EXLAN_KEY, ROW_NUM, EXLAN_LAN, EXLAN_JUNG_GUBUN, EXLAN_HS, EXLAN_JEPUM_CODE, EXLAN_JUNG, EXLAN_JUNG_DANWI, EXLAN_SU, EXLAN_SU_DANWI, 
       EXLAN_POJANG_SU, EXLAN_POJANG_DANWI, EXLAN_WHAN_JEPUM, EXLAN_HNAME, EXLAN_ENAME, EXLAN_EGUKYK, EXLAN_PUM1, EXLAN_GUKYK, EXLAN_GYELJE_GUM, 
	   EXLAN_GYELJE_FOB, EXLAN_FOB_WON, EXLAN_FOB_USD, EXLAN_IMPOSINGONO, EXLAN_IMPOLANNO, EXLAN_ATTACH_YN, EXLAN_SANGPYO, EXLAN_WONSANJI, 
	   EXLAN_WONSANJI_BANG, EXLAN_WONSANJI_PYOSI, EXLAN_COISSUEYN
FROM ( SELECT DENSE_RANK() OVER (PARTITION BY EXLAN_KEY ORDER BY EXLAN_JUNG_CD ASC)  AS ROW_NUM,
              EXLAN_KEY, EXLAN_JUNG_CD, EXLAN_LAN, '' AS EXLAN_JUNG_GUBUN, EXLAN_HS, EXLAN_JEPUM_CODE, EXLAN_JUNG, EXLAN_JUNG_DANWI, EXLAN_SU, EXLAN_SU_DANWI, 
			  EXLAN_POJANG_SU, EXLAN_POJANG_DANWI, EXLAN_WHAN_JEPUM, EXLAN_HNAME, EXLAN_ENAME, EXLAN_EGUKYK, EXLAN_PUM1, EXLAN_GUKYK, EXLAN_GYELJE_GUM, 
			  EXLAN_GYELJE_FOB, EXLAN_FOB_WON, EXLAN_FOB_USD, EXLAN_IMPOSINGONO, EXLAN_IMPOLANNO, EXLAN_ATTACH_YN, EXLAN_SANGPYO, EXLAN_WONSANJI, 
			  EXLAN_WONSANJI_BANG, EXLAN_WONSANJI_PYOSI, EXLAN_COISSUEYN
       FROM KCBA.DBO.BFEXPO2 ) A;



/* 송신_수출(정정)신고서 모델규격 */
TRUNCATE TABLE BFEXPO3;

INSERT INTO BFEXPO3 ( EXPUM_KEY, EXPUM_SEQNO, EXPUM_LAN, EXPUM_HAENG, EXPUM_JEPUM_CODE, EXPUM_PUM, EXPUM_SUNGBUN, EXPUM_SU, EXPUM_SU_DANWI, 
                      EXPUM_JUNG, EXPUM_JUNG_DANWI, EXPUM_INDOJO, EXPUM_GYELJE_MONEY, EXPUM_GYELJE_GUM, EXPUM_DANGA, EXPUM_PUM_A, EXPUM_PUM_B, 
					  EXPUM_PUM_C, EXPUM_PUM_D, EXPUM_PUM_E, EXPUM_PUM_F, EXPUM_PUM_G, EXPUM_PUM_H, EXPUM_SUNGBUN_A, EXPUM_SUNGBUN_B, 
					  EXPUM_GK1, EXPUM_GK2, EXPUM_GK3, EXPUM_GK4, EXPUM_GK5, EXPUM_PUM1, EXPUM_PUM2, EXPUM_PUM3, EXPUM_PUM4, EXPUM_PUM5 )
SELECT EXPUM_KEY, ROW_NUM, EXPUM_LAN, EXPUM_HAENG, EXPUM_JEPUM_CODE, EXPUM_PUM, EXPUM_SUNGBUN, EXPUM_SU, EXPUM_SU_DANWI, 
       EXPUM_JUNG, EXPUM_JUNG_DANWI, EXPUM_INDOJO, EXPUM_GYELJE_MONEY, EXPUM_GYELJE_GUM, EXPUM_DANGA, EXPUM_PUM_A, EXPUM_PUM_B, 
	   EXPUM_PUM_C, EXPUM_PUM_D, EXPUM_PUM_E, EXPUM_PUM_F, EXPUM_PUM_G, EXPUM_PUM_H, EXPUM_SUNGBUN_A, EXPUM_SUNGBUN_B, 
	   EXPUM_GK1, EXPUM_GK2, EXPUM_GK3, EXPUM_GK4, EXPUM_GK5, EXPUM_PUM1, EXPUM_PUM2, EXPUM_PUM3, EXPUM_PUM4, EXPUM_PUM5
FROM ( SELECT DENSE_RANK() OVER (PARTITION BY EXPUM_KEY ORDER BY EXPUM_JUNG_CD ASC)  AS ROW_NUM,
              EXPUM_KEY, EXPUM_JUNG_CD, EXPUM_LAN, EXPUM_HAENG, EXPUM_JEPUM_CODE, EXPUM_PUM, EXPUM_SUNGBUN, EXPUM_SU, EXPUM_SU_DANWI, 
			  EXPUM_JUNG, EXPUM_JUNG_DANWI, EXPUM_INDOJO, EXPUM_GYELJE_MONEY, EXPUM_GYELJE_GUM, EXPUM_DANGA, EXPUM_PUM_A, EXPUM_PUM_B, 
			  EXPUM_PUM_C, EXPUM_PUM_D, EXPUM_PUM_E, EXPUM_PUM_F, EXPUM_PUM_G, EXPUM_PUM_H, EXPUM_SUNGBUN_A, EXPUM_SUNGBUN_B, 
			  EXPUM_GK1, EXPUM_GK2, EXPUM_GK3, EXPUM_GK4, EXPUM_GK5, EXPUM_PUM1, EXPUM_PUM2, EXPUM_PUM3, EXPUM_PUM4, EXPUM_PUM5
FROM KCBA.DBO.BFEXPO3 ) A;



/* 송신_수출(정정)신고서 화물관리번호정보 */
TRUNCATE TABLE BFEXPO4;

INSERT INTO BFEXPO4 ( EXPO_KEY, EXPO_SEQNO, EXPO_CNT, EXPO_MRN_NO )
SELECT EXPO_KEY, ROW_NUM, EXPO_CNT, EXPO_MRN_NO
FROM ( SELECT DENSE_RANK() OVER (PARTITION BY EXPO_KEY ORDER BY EXPO_JUNG_CD ASC) AS ROW_NUM,
              EXPO_KEY, EXPO_JUNG_CD, EXPO_CNT, EXPO_MRN_NO
       FROM KCBA.DBO.BFEXPO4 ) A;



/* 수출_수출신고서 차대번호관리 */
TRUNCATE TABLE BFEXPO5;

INSERT INTO BFEXPO5 ( EXPO5_KEY,EXPO5_SEQNO,  EXPO5_LAN, EXPO5_HAENG, EXPO5_SEQ, EXPO5_NO )
SELECT EXPO5_KEY,ROW_NUM,  '001', '01', EXPO5_LAN, EXPO5_NO
FROM ( SELECT DENSE_RANK() OVER (PARTITION BY EXPO5_KEY ORDER BY EXPO5_JUNG_CD ASC) AS ROW_NUM,
              EXPO5_KEY, EXPO5_JUNG_CD, EXPO5_LAN, EXPO5_NO
       FROM KCBA.DBO.BFEXPO5 ) A;
/* 송신_수출(정정)신고서 */
TRUNCATE TABLE ejung1;
TRUNCATE TABLE ejung2;
TRUNCATE TABLE extotwon;

/* 송신_수출(정정)신고서 컨테이너정보관리 */
TRUNCATE TABLE BFEXCON;
INSERT INTO BFEXCON ( EXCON_KEY, EXCON_SEQNO, EXCON_SEQ, EXCON_NO )
SELECT EXCON_KEY, ROW_NUM, EXCON_SEQ, EXCON_NO
FROM ( SELECT DENSE_RANK() OVER (PARTITION BY EXCON_KEY ORDER BY EXCON_JUNG_CD ASC) AS ROW_NUM,
              EXCON_KEY, EXCON_JUNG_CD, EXCON_SEQ, EXCON_NO
       FROM KCBA.DBO.BFEXCON ) A;



/* 송신_수출(정정)신고서 요건정보 */
TRUNCATE TABLE BFEXYG;
INSERT INTO BFEXYG ( EXPO_KEY, LAN, HAENG, SEQ, EXPO_SEQNO, LAWCD, ISSUEDT, LAWAPPLYGBN, DOCGBN, YG_NO, DOCNM, MIGIJESAYU )
SELECT EXPO_KEY, LAN, '01', SEQ, ROW_NUM, LAWCD, ISSUEDT, CD1.CODE AS LAWAPPLYGBN, DOCGBN, YG_NO, DOCNM, MIGIJESAYU
FROM ( SELECT DENSE_RANK() OVER (PARTITION BY EXPO_KEY ORDER BY EXPO_JUNG_CD ASC) AS ROW_NUM,
              EXPO_KEY, LAN, SEQ, EXPO_JUNG_CD, LAWCD, ISSUEDT, LAWAPPLYGBN, DOCGBN, YG_NO, DOCNM, MIGIJESAYU
       FROM KCBA.DBO.BFEXYG ) A
LEFT JOIN CDSTD CD1 ON A.LAWAPPLYGBN = CD1.CODE3 AND CD1.CLASS = '1590' AND CD1.CODE3 <> '';



/* 송신_수출(정정)신고서 요건번호 등록 */
TRUNCATE TABLE BFEXYOG;
INSERT INTO BFEXYOG ( EXYOG_KEY, EXYOG_SEQNO, EXYOG_SEQ, EXYOG_GUBUN, EXYOG_NO, EXYOG_PAPER_NAME, EXYOG_DATE, EXYOG_BUHO )
SELECT EXYOG_KEY, ROW_NUM, EXYOG_SEQ, EXYOG_GUBUN, EXYOG_NO, EXYOG_PAPER_NAME, EXYOG_DATE, EXYOG_BUHO
FROM ( SELECT DENSE_RANK() OVER (PARTITION BY EXYOG_KEY ORDER BY EXYOG_JUNG_CD ASC) AS ROW_NUM,
              EXYOG_KEY, EXYOG_JUNG_CD, EXYOG_SEQ, EXYOG_GUBUN, EXYOG_NO, EXYOG_PAPER_NAME, EXYOG_DATE, EXYOG_BUHO
       FROM KCBA.DBO.BFEXYOG ) A;
