/*
속도 개선을 위하여 TRUNCATE TABLE 로 변경합니다. BY MKIM 20160219
*/

/* 수신_세금계산서(개별) */
TRUNCATE TABLE VAT5FV;
INSERT INTO VAT5FV (
VATTYPE, BALHANGNO, SUIPJANO, SAUPGBN, SUIPJASANGHO, SUIPJANAME, SUIPJAJUSO, SINGONO, NAPBUDATE, GONGLAN, GWASEPYOJUN, VAT, GOJINO, WHANGYELNO, WHANSAYU, JJDATE, REBALHANGYN, GYOBUSAYU, TONGBODATE, PRT_YN, FAX_SEND
       )
SELECT 
CASE WHEN VATTYPE = '1' THEN '01' WHEN VATTYPE = '2' THEN '02' ELSE '' END AS  VATTYPE, BALHANGNO, SUIPJANO, SAUPGBN, SUIPJASANGHO, SUIPJANAME, SUIPJAJUSO, SINGONO, NAPBUDATE, GONGLAN, GWASEPYOJUN, VAT, GOJINO, WHANGYELNO, WHANSAYU, JJDATE, REBALHANGYN, GYOBUSAYU, TONGBODATE, PRT_YN, FAX_SEND
FROM KCBA.VAT5FV;




/* 수신_세금계산서(일괄,월별) 공통사항 */
TRUNCATE TABLE VAT5FZ;
INSERT INTO VAT5FZ (
GNO, SGNO, SEGWAN_SAUP, SEGWAN_NAME1, SEGWAN_NAME2, SEGWAN_JUSO1, SEGWAN_JUSO2, NAPBUJA_SAUP, NAPBUJA_SANGHO, NAPBUJA_NAME, NAPBUJA_JUSO1, NAPBUJA_JUSO2, NAPBU_DATE, GONGLAN, GWASE_POJUN, VAT_TAX, BATCH_GIGAN, BIGO, GESANSO_KIND, 
GESANSO_GUBUN, TONGBO_DATE, DTLCNT, NAPBU_NO, PRT_YN
       )
SELECT 
GNO, SGNO, SEGWAN_SAUP, SEGWAN_NAME1, SEGWAN_NAME2, SEGWAN_JUSO1, SEGWAN_JUSO2, NAPBUJA_SAUP, NAPBUJA_SANGHO, NAPBUJA_NAME, NAPBUJA_JUSO1, NAPBUJA_JUSO2, NAPBU_DATE, GONGLAN, GWASE_POJUN, VAT_TAX, BATCH_GIGAN, BIGO, GESANSO_KIND, 
CASE WHEN GESANSO_GUBUN = '1' THEN '01' WHEN GESANSO_GUBUN = '2' THEN '02' ELSE '' END AS  GESANSO_GUBUN, TONGBO_DATE, DTLCNT, NAPBU_NO, PRT_YN
FROM KCBA.VAT5FZ;

/* 수신_세금계산서(일괄,월별) 상세정보 */
TRUNCATE TABLE VAT5FZDTL;
INSERT INTO VAT5FZDTL (
GNO, SEQ, NAPBU_DATE, SINGONO, NAPBU_NO, GWASE_POJUN, VAT_TAX       
)
SELECT 
GNO, SEQ, NAPBU_DATE, SINGONO, NAPBU_NO, GWASE_POJUN, VAT_TAX       
FROM KCBA.VAT5FZDTL;

/* 기타 
TRUNCATE TABLE VATPRIV
INSERT INTO VATPRIV (
VATKEY, VATSINGONO, VATGOJINO, VATWHANRESOLUTIONNO, VATIMPOSANGHO, VATIMPOONWER, VATIMPOREGNO, VATIMPOJUSO1, VATIMPOJUSO2, VATRECEIPTDATE, VATBLANKNUM, VATTAXATION, VATTAXAMOUNT, VATMODIFYDATE, VATDELIVERYREASON, VATBILLTYPE, VATWHANREASON, VATREISSUEYN, VATPRNYN, VATUPTE, VATJONG, VATFILENO1, VATFILENO2, VATBLNO, VATBATCH
)
SELECT 
VATKEY, VATSINGONO, VATGOJINO, VATWHANRESOLUTIONNO, VATIMPOSANGHO, VATIMPOONWER, VATIMPOREGNO, VATIMPOJUSO1, VATIMPOJUSO2, VATRECEIPTDATE, VATBLANKNUM, VATTAXATION, VATTAXAMOUNT, VATMODIFYDATE, VATDELIVERYREASON, VATBILLTYPE, VATWHANREASON, VATREISSUEYN, VATPRNYN, VATUPTE, VATJONG, VATFILENO1, VATFILENO2, VATBLNO, VATBATCH
FROM KCBA.VATPRIV
*/