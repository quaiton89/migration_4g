/* 송신_수출(정정)신고서 공통사항 */

SET @ROW_NUM :=1;
SET @EXPO_KEY := '';
SET @EXPO_JUNG_CD := '';

DELETE FROM BFEXPO1;

INSERT INTO BFEXPO1 ( EXPO_KEY, EXPO_SEQNO, EXPO_YEAR, EXPO_JECHLNO, EXPO_CHK_DG, EXPO_SAVE_GBN, EXPO_LOCAL_GUBUN, EXPO_GEYAK_NO1, EXPO_GEYAK_NO2, 
                      EXPO_TCANO, EXPO_JIYEK_GBN, EXPO_SINGOJA_SANGHO, EXPO_SUCHULJA_CODE, EXPO_SUCHULJA_SANGHO, EXPO_SUCHULJA_BUHO, EXPO_SUCHULJA_GBN, 
					  EXPO_WHAJU_CODE, EXPO_WHAJU_SANGHO, EXPO_WHAJU_JUSO, EXPO_WHAJU_NAME, EXPO_WHAJU_TONG, EXPO_WHAJU_SAUP_GBN, EXPO_WHAJU_SAUP, 
					  EXPO_GUMAEJA_CODE, EXPO_GUMAEJA_SANGHO, EXPO_GUMAEJA_NATION, EXPO_WHAN_SIN, EXPO_WHAN_BUHO, EXPO_WHAN_GIGWAN, EXPO_SEGWAN, 
					  EXPO_GWA, EXPO_SINGO_YEAR, EXPO_SINGO_NO, EXPO_SINGO_DG, EXPO_SINGO_DATE, EXPO_SINGO_GBN, EXPO_GUMSA_GBN, EXPO_GURAE_GBN, EXPO_JONG, 
					  EXPO_GYELJE, EXPO_MOKJUK_CODE, EXPO_MOKJUK_NAME, EXPO_HANGGU_CODE, EXPO_HANGGU_NAME, EXPO_UNSONG_TYPE, EXPO_UNSONG_BOX, EXPO_JEJO_DATE, 
					  EXPO_POST, EXPO_JUSO, EXPO_LC_NO, EXPO_IV_NO, EXPO_CHAMJO_NO, EXPO_LAN, EXPO_TOTAL_JUNG, EXPO_JUNG_DANWI, EXPO_POJANG_SU, EXPO_USD_EXCH, 
					  EXPO_TOTAL_WON, EXPO_TOTAL_USD, EXPO_INDOJO, EXPO_GYELJE_MONEY, EXPO_GYELJE_EXCH, EXPO_GYELJE_INPUT, EXPO_CALC_YN, EXPO_FRE_MONEY, 
					  EXPO_FRE_EXCH, EXPO_FRE_INPUT, EXPO_FRE_CALC, EXPO_INS_MONEY, EXPO_INS_EXCH, EXPO_INS_INPUT, EXPO_INS_CALC, EXPO_ETC_MONEY, EXPO_ETC_EXCH, 
					  EXPO_ETC_INPUT, EXPO_ETC_GUM, EXPO_SEUNG_NO, EXPO_SEUNG_CH_DATE, EXPO_SEUNG_DATE, EXPO_SAYU, EXPO_CHUCHEON_NO, EXPO_CHUCHEON_DATE, 
					  EXPO_GUMSA_NO, EXPO_GUMSA_DATE, EXPO_GUMYEOK_NO, EXPO_GUMYEOK_DATE, EXPO_JUNLYK_NO, EXPO_JUNLYK_DATE, EXPO_UNSONG_CODE, EXPO_UNSONG_SANGHO, 
					  EXPO_UNSONG_DATE1, EXPO_UNSONG_DATE2, EXPO_RES_TYPE, EXPO_SEND_GBN, EXPO_GIJELAN, EXPO_OK_DATE, EXPO_OK_NO, EXPO_JUNSONG_RESULT, EXPO_RES_RESULT, 
					  EXPO_ACCCNV, EXPO_DAMDANGJA, EXPO_JANGCHI_CNT, EXPO_WEBSERVER, EXPO_DAECODE, EXPO_DAESANGHO, EXPO_DAESAUPNO, EXPO_SUCHULSAUPNO, EXPO_SUCHUL_UPTE, 
					  EXPO_SUCHUL_JONGMOK, EXPO_WHAJU_UPTE, EXPO_WHAJU_JONGMOK, LOG_TYPE, EVENT_TYPE, EXPO_IMSIGAE_YN, EXPO_BANSONG_SAYU, EXPO_MRN_BUNHAL, EXPO_SUNJUK_DATE, 
					  EXPO_TCA_SILJUK, EXPO_OLD_YN, FAX_SEND, EXPO_TRUST_CODE, EXPO_TRUST_SANGHO, EXPO_TRUST_JUSO, EXPO_TRUST_NAME, EXPO_TRUST_TONG, EXPO_TRUST_SAUP, 
					  EXPO_TRUST_SAUP_GBN, EXPO_TRUST_GUBUN, SCAN_LINK, EXPO_WHAN_GAN2, EXPO_INDUSTRY, EXPO_HOW_CHECK, EXPO_POJANG_DANWI, EXPO_SINGOJA_GIJE, 
					  EXPO_SINGOJA_NAME, EXPO_JUKIP_YN, EXPO_JUNG_CD2, USERNO, FORWARD_CODE, FORWARD_SANGHO, EXPO_ENG_ADDRESS, EXPO_LEAVE_DAY, EXPO_SOUTHNORTHTRADEYN, 
					  EXPO_UCR, EXPO_SUCHULJA_TONG, EXPO_TRUST_POST, MAIL_SEND, SMSSEND, USERID, USERNM, ADDDTTIME, EDITDTTIME, EXPO_PRELOADAREACD, EXPO_PRESTARTDT, 
					  EXPO_SHIPAIRCOMCD, EXPO_SHIPAIRCOMNM, EXPO_SHIPAIRNM, EXPO_LOADED_YN, EXPO_SEBUHO, EXPO_SEDMDNGNM, ATTACHIMAGEYN, EXPO_JANGCHI_CODE, EXPO_BANIP_NO, 
					  EXPO_LOADEDDT, SENDERNM, BFLOADCHK )
SELECT B.EXPO_KEY, A.ROW_NUM, EXPO_YEAR, EXPO_JECHLNO, EXPO_CHK_DG, EXPO_SAVE_GBN, EXPO_LOCAL_GUBUN, EXPO_GEYAK_NO1, EXPO_GEYAK_NO2, 
                      EXPO_TCANO, EXPO_JIYEK_GBN, EXPO_SINGOJA_SANGHO, EXPO_SUCHULJA_CODE, EXPO_SUCHULJA_SANGHO, EXPO_SUCHULJA_BUHO, EXPO_SUCHULJA_GBN, 
					  EXPO_WHAJU_CODE, EXPO_WHAJU_SANGHO, EXPO_WHAJU_JUSO, EXPO_WHAJU_NAME, EXPO_WHAJU_TONG, EXPO_WHAJU_SAUP_GBN, EXPO_WHAJU_SAUP, 
					  EXPO_GUMAEJA_CODE, EXPO_GUMAEJA_SANGHO, EXPO_GUMAEJA_NATION, EXPO_WHAN_SIN, EXPO_WHAN_BUHO, EXPO_WHAN_GIGWAN, EXPO_SEGWAN, 
					  EXPO_GWA, EXPO_SINGO_YEAR, EXPO_SINGO_NO, EXPO_SINGO_DG, EXPO_SINGO_DATE, EXPO_SINGO_GBN, EXPO_GUMSA_GBN, EXPO_GURAE_GBN, EXPO_JONG, 
					  EXPO_GYELJE, EXPO_MOKJUK_CODE, EXPO_MOKJUK_NAME, EXPO_HANGGU_CODE, EXPO_HANGGU_NAME, EXPO_UNSONG_TYPE, EXPO_UNSONG_BOX, EXPO_JEJO_DATE, 
					  EXPO_POST, EXPO_JUSO, EXPO_LC_NO, EXPO_IV_NO, EXPO_CHAMJO_NO, EXPO_LAN, EXPO_TOTAL_JUNG, EXPO_JUNG_DANWI, EXPO_POJANG_SU, EXPO_USD_EXCH, 
					  EXPO_TOTAL_WON, EXPO_TOTAL_USD, EXPO_INDOJO, EXPO_GYELJE_MONEY, EXPO_GYELJE_EXCH, EXPO_GYELJE_INPUT, EXPO_CALC_YN, EXPO_FRE_MONEY, 
					  EXPO_FRE_EXCH, EXPO_FRE_INPUT, EXPO_FRE_CALC, EXPO_INS_MONEY, EXPO_INS_EXCH, EXPO_INS_INPUT, EXPO_INS_CALC, EXPO_ETC_MONEY, EXPO_ETC_EXCH, 
					  EXPO_ETC_INPUT, EXPO_ETC_GUM, EXPO_SEUNG_NO, EXPO_SEUNG_CH_DATE, EXPO_SEUNG_DATE, EXPO_SAYU, EXPO_CHUCHEON_NO, EXPO_CHUCHEON_DATE, 
					  EXPO_GUMSA_NO, EXPO_GUMSA_DATE, EXPO_GUMYEOK_NO, EXPO_GUMYEOK_DATE, EXPO_JUNLYK_NO, EXPO_JUNLYK_DATE, EXPO_UNSONG_CODE, EXPO_UNSONG_SANGHO, 
					  EXPO_UNSONG_DATE1, EXPO_UNSONG_DATE2, EXPO_RES_TYPE, EXPO_SEND_GBN, EXPO_GIJELAN, EXPO_OK_DATE, EXPO_OK_NO, EXPO_JUNSONG_RESULT, EXPO_RES_RESULT, 
					  EXPO_ACCCNV, EXPO_DAMDANGJA, EXPO_JANGCHI_CNT, EXPO_WEBSERVER, EXPO_DAECODE, EXPO_DAESANGHO, EXPO_DAESAUPNO, EXPO_SUCHULSAUPNO, EXPO_SUCHUL_UPTE, 
					  EXPO_SUCHUL_JONGMOK, EXPO_WHAJU_UPTE, EXPO_WHAJU_JONGMOK, LOG_TYPE, EVENT_TYPE, EXPO_IMSIGAE_YN, EXPO_BANSONG_SAYU, EXPO_MRN_BUNHAL, EXPO_SUNJUK_DATE, 
					  EXPO_TCA_SILJUK, EXPO_OLD_YN, FAX_SEND, EXPO_TRUST_CODE, EXPO_TRUST_SANGHO, EXPO_TRUST_JUSO, EXPO_TRUST_NAME, EXPO_TRUST_TONG, EXPO_TRUST_SAUP, 
					  EXPO_TRUST_SAUP_GBN, EXPO_TRUST_GUBUN, SCAN_LINK, EXPO_WHAN_GAN2, EXPO_INDUSTRY, EXPO_HOW_CHECK, EXPO_POJANG_DANWI, EXPO_SINGOJA_GIJE, 
					  EXPO_SINGOJA_NAME, EXPO_JUKIP_YN, EXPO_JUNG_CD2, USERNO, FORWARD_CODE, FORWARD_SANGHO, EXPO_ENG_ADDRESS, EXPO_LEAVE_DAY, EXPO_SOUTHNORTHTRADEYN, 
					  EXPO_UCR, EXPO_SUCHULJA_TONG, EXPO_TRUST_POST, MAIL_SEND, SMSSEND, USERID, USERNM, ADDDTTIME, EDITDTTIME, EXPO_PRELOADAREACD, EXPO_PRESTARTDT, 
					  EXPO_SHIPAIRCOMCD, EXPO_SHIPAIRCOMNM, EXPO_SHIPAIRNM, EXPO_LOADED_YN, EXPO_SEBUHO, EXPO_SEDMDNGNM, ATTACHIMAGEYN, EXPO_JANGCHI_CODE, EXPO_BANIP_NO, 
					  EXPO_LOADEDDT, SENDERNM, BFLOADCHK 
FROM ( SELECT @ROW_NUM := 
              CASE WHEN (@EXPO_KEY = EXPO_KEY AND @EXPO_JUNG_CD != EXPO_JUNG_CD) THEN @ROW_NUM + 1 
              WHEN (@EXPO_KEY != EXPO_KEY AND @EXPO_JUNG_CD != EXPO_JUNG_CD) THEN 1 
              ELSE @ROW_NUM END AS ROW_NUM,
              @EXPO_KEY := EXPO_KEY AS EXPO_KEY,
              @EXPO_JUNG_CD := EXPO_JUNG_CD AS EXPO_JUNG_CD
       FROM KCBA.BFEXPO1
       ORDER BY EXPO_KEY, EXPO_JUNG_CD ) A
JOIN KCBA.BFEXPO1 B ON A.EXPO_KEY = B.EXPO_KEY AND A.EXPO_JUNG_CD = B.EXPO_JUNG_CD;





/* 송신_수출(정정)신고서 란사항 */

SET @ROW_NUM :=1;
SET @EXLAN_KEY := '';
SET @EXLAN_JUNG_CD := '';
SET @EXLAN_LAN :=1;

DELETE FROM BFEXPO2;

INSERT INTO BFEXPO2 ( EXLAN_KEY, EXLAN_SEQNO, EXLAN_LAN, EXLAN_JUNG_GUBUN, EXLAN_HS, EXLAN_JEPUM_CODE, EXLAN_JUNG, EXLAN_JUNG_DANWI, EXLAN_SU, EXLAN_SU_DANWI, 
                      EXLAN_POJANG_SU, EXLAN_POJANG_DANWI, EXLAN_WHAN_JEPUM, EXLAN_HNAME, EXLAN_ENAME, EXLAN_EGUKYK, EXLAN_PUM1, EXLAN_GUKYK, EXLAN_GYELJE_GUM, 
					  EXLAN_GYELJE_FOB, EXLAN_FOB_WON, EXLAN_FOB_USD, EXLAN_IMPOSINGONO, EXLAN_IMPOLANNO, EXLAN_ATTACH_YN, EXLAN_SANGPYO, EXLAN_WONSANJI, 
					  EXLAN_WONSANJI_BANG, EXLAN_WONSANJI_PYOSI, EXLAN_COISSUEYN )
SELECT A.EXLAN_KEY, A.ROW_NUM, A.EXLAN_LAN, '' AS EXLAN_JUNG_GUBUN, EXLAN_HS, EXLAN_JEPUM_CODE, EXLAN_JUNG, EXLAN_JUNG_DANWI, EXLAN_SU, EXLAN_SU_DANWI, 
                      EXLAN_POJANG_SU, EXLAN_POJANG_DANWI, EXLAN_WHAN_JEPUM, EXLAN_HNAME, EXLAN_ENAME, EXLAN_EGUKYK, EXLAN_PUM1, EXLAN_GUKYK, EXLAN_GYELJE_GUM, 
					  EXLAN_GYELJE_FOB, EXLAN_FOB_WON, EXLAN_FOB_USD, EXLAN_IMPOSINGONO, EXLAN_IMPOLANNO, EXLAN_ATTACH_YN, EXLAN_SANGPYO, EXLAN_WONSANJI, 
					  EXLAN_WONSANJI_BANG, EXLAN_WONSANJI_PYOSI, EXLAN_COISSUEYN
FROM ( SELECT @ROW_NUM := 
              CASE WHEN (@EXLAN_KEY = EXLAN_KEY AND @EXLAN_JUNG_CD != EXLAN_JUNG_CD) THEN @ROW_NUM + 1 
              WHEN (@EXLAN_KEY != EXLAN_KEY AND @EXLAN_JUNG_CD != EXLAN_JUNG_CD) THEN 1 
              ELSE @ROW_NUM END AS ROW_NUM,
              @EXLAN_KEY := EXLAN_KEY AS EXLAN_KEY,
              @EXLAN_JUNG_CD := EXLAN_JUNG_CD AS EXLAN_JUNG_CD,
              @EXLAN_LAN := EXLAN_LAN AS EXLAN_LAN
       FROM KCBA.BFEXPO2
       ORDER BY EXLAN_KEY, EXLAN_JUNG_CD ) A
JOIN KCBA.BFEXPO2 B ON A.EXLAN_KEY = B.EXLAN_KEY AND A.EXLAN_JUNG_CD = B.EXLAN_JUNG_CD AND A.EXLAN_LAN = B.EXLAN_LAN
ORDER BY B.EXLAN_KEY, A.ROW_NUM ASC;




/* 송신_수출(정정)신고서 모델규격 */

SET @ROW_NUM :=1;
SET @EXPUM_KEY := '';
SET @EXPUM_JUNG_CD := '';
SET @EXPUM_LAN := '';
SET @EXPUM_HAENG := '';

DELETE FROM BFEXPO3;

INSERT INTO BFEXPO3 ( EXPUM_KEY, EXPUM_SEQNO, EXPUM_LAN, EXPUM_HAENG, EXPUM_JEPUM_CODE, EXPUM_PUM, EXPUM_SUNGBUN, EXPUM_SU, EXPUM_SU_DANWI, 
                      EXPUM_JUNG, EXPUM_JUNG_DANWI, EXPUM_INDOJO, EXPUM_GYELJE_MONEY, EXPUM_GYELJE_GUM, EXPUM_DANGA, EXPUM_PUM_A, EXPUM_PUM_B, 
					  EXPUM_PUM_C, EXPUM_PUM_D, EXPUM_PUM_E, EXPUM_PUM_F, EXPUM_PUM_G, EXPUM_PUM_H, EXPUM_SUNGBUN_A, EXPUM_SUNGBUN_B, 
					  EXPUM_GK1, EXPUM_GK2, EXPUM_GK3, EXPUM_GK4, EXPUM_GK5, EXPUM_PUM1, EXPUM_PUM2, EXPUM_PUM3, EXPUM_PUM4, EXPUM_PUM5 )
SELECT A.EXPUM_KEY, A.ROW_NUM, A.EXPUM_LAN, A.EXPUM_HAENG, EXPUM_JEPUM_CODE, EXPUM_PUM, EXPUM_SUNGBUN, EXPUM_SU, EXPUM_SU_DANWI, 
                      EXPUM_JUNG, EXPUM_JUNG_DANWI, EXPUM_INDOJO, EXPUM_GYELJE_MONEY, EXPUM_GYELJE_GUM, EXPUM_DANGA, EXPUM_PUM_A, EXPUM_PUM_B, 
					  EXPUM_PUM_C, EXPUM_PUM_D, EXPUM_PUM_E, EXPUM_PUM_F, EXPUM_PUM_G, EXPUM_PUM_H, EXPUM_SUNGBUN_A, EXPUM_SUNGBUN_B, 
					  EXPUM_GK1, EXPUM_GK2, EXPUM_GK3, EXPUM_GK4, EXPUM_GK5, EXPUM_PUM1, EXPUM_PUM2, EXPUM_PUM3, EXPUM_PUM4, EXPUM_PUM5
FROM ( SELECT @ROW_NUM := 
              CASE WHEN (@EXPUM_KEY = EXPUM_KEY AND @EXPUM_JUNG_CD != EXPUM_JUNG_CD) THEN @ROW_NUM + 1 
              WHEN (@EXPUM_KEY != EXPUM_KEY AND @EXPUM_JUNG_CD != EXPUM_JUNG_CD) THEN 1 
              ELSE @ROW_NUM END AS ROW_NUM,
              @EXPUM_KEY := EXPUM_KEY AS EXPUM_KEY,
              @EXPUM_JUNG_CD := EXPUM_JUNG_CD AS EXPUM_JUNG_CD,
              @EXPUM_LAN := EXPUM_LAN AS EXPUM_LAN,
              @EXPUM_HAENG := EXPUM_HAENG AS EXPUM_HAENG
      FROM KCBA.BFEXPO3
      ORDER BY EXPUM_KEY, EXPUM_JUNG_CD ) A
JOIN KCBA.BFEXPO3 B ON A.EXPUM_KEY = B.EXPUM_KEY AND A.EXPUM_JUNG_CD = B.EXPUM_JUNG_CD AND A.EXPUM_LAN = B.EXPUM_LAN AND A.EXPUM_HAENG = B.EXPUM_HAENG;



/* 송신_수출(정정)신고서 화물관리번호정보 */


SET @ROW_NUM :=1;
SET @EXPO_KEY := '';
SET @EXPO_JUNG_CD := '';
SET @EXPO_CNT := '';

DELETE FROM BFEXPO4;

INSERT INTO BFEXPO4 ( EXPO_KEY, EXPO_SEQNO, EXPO_CNT, EXPO_MRN_NO )
SELECT A.EXPO_KEY, A.ROW_NUM, A.EXPO_CNT, B.EXPO_MRN_NO
FROM (SELECT @ROW_NUM := 
             CASE WHEN (@EXPO_KEY = EXPO_KEY AND @EXPO_JUNG_CD != EXPO_JUNG_CD) THEN @ROW_NUM + 1 
             WHEN (@EXPO_KEY != EXPO_KEY AND @EXPO_JUNG_CD != EXPO_JUNG_CD) THEN 1 
             ELSE @ROW_NUM END AS ROW_NUM,
             @EXPO_KEY := EXPO_KEY AS EXPO_KEY,
             @EXPO_JUNG_CD := EXPO_JUNG_CD AS EXPO_JUNG_CD,
             @EXPO_CNT := EXPO_CNT AS EXPO_CNT
      FROM KCBA.BFEXPO4
      ORDER BY EXPO_KEY, EXPO_JUNG_CD ) A
JOIN KCBA.BFEXPO4 B ON A.EXPO_KEY = B.EXPO_KEY AND A.EXPO_JUNG_CD = B.EXPO_JUNG_CD AND A.EXPO_CNT = B.EXPO_CNT;




/* 수출_수출신고서 차대번호관리 */

SET @ROW_NUM :=1;
SET @EXPO5_KEY := '';
SET @EXPO5_JUNG_CD := '';
SET @EXPO5_LAN := '';

DELETE FROM BFEXPO5;

INSERT INTO BFEXPO5 ( EXPO5_KEY, EXPO5_SEQNO, EXPO5_LAN, EXPO5_HAENG, EXPO5_SEQ, EXPO5_NO )
SELECT A.EXPO5_KEY, A.ROW_NUM, '001', '01', A.EXPO5_LAN, B.EXPO5_NO
FROM ( SELECT @ROW_NUM := 
              CASE WHEN (@EXPO5_KEY = EXPO5_KEY AND @EXPO5_JUNG_CD != EXPO5_JUNG_CD) THEN @ROW_NUM + 1 
              WHEN (@EXPO5_KEY != EXPO5_KEY AND @EXPO5_JUNG_CD != EXPO5_JUNG_CD) THEN 1 
              ELSE @ROW_NUM END AS ROW_NUM,
            @EXPO5_KEY := EXPO5_KEY AS EXPO5_KEY,
            @EXPO5_JUNG_CD := EXPO5_JUNG_CD AS EXPO5_JUNG_CD,
            @EXPO5_LAN := EXPO5_LAN AS EXPO5_LAN
       FROM KCBA.BFEXPO5
       ORDER BY EXPO5_KEY, EXPO5_JUNG_CD ) A
JOIN KCBA.BFEXPO5 B ON A.EXPO5_KEY = B.EXPO5_KEY AND A.EXPO5_JUNG_CD = B.EXPO5_JUNG_CD AND A.EXPO5_LAN = B.EXPO5_LAN;



/* 송신_수출(정정)신고서 컨테이너정보관리 */

SET @ROW_NUM :=1;
SET @EXCON_KEY := '';
SET @EXCON_JUNG_CD := '';
SET @EXCON_SEQ := '';

DELETE FROM BFEXCON;

INSERT INTO BFEXCON ( EXCON_KEY, EXCON_SEQNO, EXCON_SEQ, EXCON_NO )
SELECT A.EXCON_KEY, A.ROW_NUM, A.EXCON_SEQ, B.EXCON_NO
FROM ( SELECT @ROW_NUM := 
              CASE WHEN (@EXCON_KEY = EXCON_KEY AND @EXCON_JUNG_CD != EXCON_JUNG_CD) THEN @ROW_NUM + 1 
              WHEN (@EXCON_KEY != EXCON_KEY AND @EXCON_JUNG_CD != EXCON_JUNG_CD) THEN 1 
              ELSE @ROW_NUM END AS ROW_NUM,
              @EXCON_KEY := EXCON_KEY AS EXCON_KEY,
              @EXCON_JUNG_CD := EXCON_JUNG_CD AS EXCON_JUNG_CD,
              @EXCON_SEQ := EXCON_SEQ AS EXCON_SEQ             
       FROM KCBA.BFEXCON
       ORDER BY EXCON_KEY, EXCON_JUNG_CD ) A
JOIN KCBA.BFEXCON B ON A.EXCON_KEY = B.EXCON_KEY AND A.EXCON_JUNG_CD = B.EXCON_JUNG_CD AND A.EXCON_SEQ = B.EXCON_SEQ;





/* 송신_수출(정정)신고서 요건정보 */

SET @ROW_NUM :=1;
SET @EXPO_KEY := '';
SET @EXPO_JUNG_CD := '';
SET @LAN := '';
SET @SEQ := '';

DELETE FROM BFEXYG;

INSERT INTO BFEXYG ( EXPO_KEY, LAN, HAENG, SEQ, EXPO_SEQNO, LAWCD, ISSUEDT, LAWAPPLYGBN, DOCGBN, YG_NO, DOCNM, MIGIJESAYU )

SELECT A.EXPO_KEY, A.LAN, '01', A.SEQ, A.ROW_NUM, LAWCD, ISSUEDT, LAWAPPLYGBN, DOCGBN, YG_NO, DOCNM, MIGIJESAYU
FROM ( SELECT @ROW_NUM := 
              CASE WHEN (@EXPO_KEY = EXPO_KEY AND @EXPO_JUNG_CD != EXPO_JUNG_CD) THEN @ROW_NUM + 1 
              WHEN (@EXPO_KEY != EXPO_KEY AND @EXPO_JUNG_CD != EXPO_JUNG_CD) THEN 1 
              ELSE @ROW_NUM END AS ROW_NUM,
              @EXPO_KEY := EXPO_KEY AS EXPO_KEY,
              @EXPO_JUNG_CD := EXPO_JUNG_CD AS EXPO_JUNG_CD,
              @LAN := LAN AS LAN,
              @SEQ := SEQ AS SEQ
       FROM KCBA.BFEXYG
       ORDER BY EXPO_KEY, EXPO_JUNG_CD ) A
JOIN KCBA.BFEXYG B ON A.EXPO_KEY = B.EXPO_KEY AND A.EXPO_JUNG_CD = B.EXPO_JUNG_CD AND A.LAN = B.LAN AND A.SEQ = B.SEQ
LEFT JOIN CDSTD CD1 ON B.LAWAPPLYGBN = CD1.CODE3 AND CD1.CLASS = '1590' AND CD1.CODE3 <> '';





/* 송신_수출(정정)신고서 요건번호 등록 */


SET @ROW_NUM :=1;
SET @EXYOG_KEY := '';
SET @EXYOG_JUNG_CD := '';
SET @EXYOG_SEQ := '';

DELETE FROM BFEXYOG;

INSERT INTO BFEXYOG ( EXYOG_KEY, EXYOG_SEQNO, EXYOG_SEQ, EXYOG_GUBUN, EXYOG_NO, EXYOG_PAPER_NAME, EXYOG_DATE, EXYOG_BUHO )
SELECT A.EXYOG_KEY, A.ROW_NUM, A.EXYOG_SEQ, EXYOG_GUBUN, EXYOG_NO, EXYOG_PAPER_NAME, EXYOG_DATE, EXYOG_BUHO
FROM ( SELECT @ROW_NUM := 
              CASE WHEN (@EXYOG_KEY = EXYOG_KEY AND @EXYOG_JUNG_CD != EXYOG_JUNG_CD) THEN @ROW_NUM + 1 
              WHEN (@EXYOG_KEY != EXYOG_KEY AND @EXYOG_JUNG_CD != EXYOG_JUNG_CD) THEN 1 
              ELSE @ROW_NUM END AS ROW_NUM,
              @EXYOG_KEY := EXYOG_KEY AS EXYOG_KEY,
              @EXYOG_JUNG_CD := EXYOG_JUNG_CD AS EXYOG_JUNG_CD,
              @EXYOG_SEQ := EXYOG_SEQ AS EXYOG_SEQ
       FROM KCBA.BFEXYOG
       ORDER BY EXYOG_KEY, EXYOG_JUNG_CD ) A
JOIN KCBA.BFEXYOG B ON A.EXYOG_KEY = B.EXYOG_KEY AND A.EXYOG_JUNG_CD = B.EXYOG_JUNG_CD AND A.EXYOG_SEQ = B.EXYOG_SEQ;