/*
1. 속도 개선을 위하여 TRUNCATE TABLE 로 변경합니다. BY MKIM 20160219
*/


/* 송신_가격신고서 NEW */

TRUNCATE TABLE GAKYKNEW;

INSERT INTO GAKYKNEW (
JYY, JNO, JDG, CIFDECIDEWAY, APPRCODE, SENDGBN, WRITTENDATE, DECIDEDATE, DOCTYPE, CUSTOMCODE, DEPTCODE, SELLERCOMPANY, SELLERADDRESS, SELLERNAME, BUYERCOMPANY, BUYERADDRESS, BUYERNAME, DECIDENUMBER, A6A, 
A6B, A6C, A7A, A7B, A8A, A8B, INVOICENUMBER, INVOICEDATE, CONTRACTNUMBER, CONTRACTDATE, PROVCUSTOMCODE, PROVDEPTCODE, PROVYY, PROVNUMBER, WRITERPLACE, WRITERNAME, WRITERPHONENUMBER, 
BVALUATIONTYPE, BCIFGUESS, BVERIFYDATA1, BVERIFYDATA2, B10AA, B10AB, B10AC, B10AD, B10AE, B10AF, B10AG, B10AOTHERREASON, B10BA, B10BB, B10BC, B10BD, B10BE, B10BOTHERREASON, A11ACOST, A11ACURRENCY, A11AEXCHRATE, A11BCOST, A12COST, A13ACOST, A13BCOST, A13CCOST, A14ACOST, A14BCOST, A14CCOST, A14DCOST, A15COST, A16COST, A17COST, A17ACOST, A17BCOST, A17CCOST, A18COST, A19COST, A20COST, A21COST, A22COST, A23COST, B12COST, B12CURRENCY, B12EXCHRATE, B12KRWCOST, B13ACOST, B13BCOST, B13CCOST, B13DCOST, B13ECOST, B14COST, B15ACOST, B15BCOST, B15CCOST, B15DCOST, B15ECOST, B16COST, B18COST, B18CURRENCY, B18EXCHRATE, B18KRWCOST, BECUSTOMNUMBER, B19ACOST, B19BCOST, B19BRATE, B19BRATEGBN, B19CCOST, B19DCOST, B19ECOST, B19FCOST, B19GCOST, B19HCOST, B20COST, B22COST, B23ACOST, B23BCOST, B23CCOST, B24COST, PROVADDRATE, PROVVALUEDATE, PROVCONTRACTEXPIRYDATE, PROVSAYUA, PROVSAYUB, PROVSAYUC, PROVSAYUD, PROVSAYUE, PROVSAYUF, PROVSAYUG, PROVSAYUH, PROVSAYUI, PROVSAYUJ, PROVSAYUK, PROVSAYUL, PROVSAYUM, PROVSAYULREASON, PROVADDCOST, CIFKRW, SENDFLAG, RECVFLAG, JUBSUDATE, LICENSEDATE, LASTEDITDATETIME, CUSTOMWRITTENLAN, FAX_SEND, NAPSE_SANGHO, NAPSE_SAUP, CHARGEPLACE, CHARGENAME, CHARGETEL, PROVSAYUN, PROVSAYUO, PROVSAYUP, PROVSAYUQ, A7D, 
A7E, A7E_ETC, PONO, PODATE
)
SELECT 
JYY, JNO, JDG, CIFDECIDEWAY, APPRCODE, SENDGBN, WRITTENDATE, DECIDEDATE, DOCTYPE, CUSTOMCODE, DEPTCODE, SELLERCOMPANY, SELLERADDRESS, SELLERNAME, BUYERCOMPANY, BUYERADDRESS, BUYERNAME, DECIDENUMBER, A6A, 
CD1.CODE AS A6B, A6C, A7A, A7B, A8A, A8B, INVOICENUMBER, INVOICEDATE, CONTRACTNUMBER, CONTRACTDATE, PROVCUSTOMCODE, PROVDEPTCODE, PROVYY, PROVNUMBER, WRITERPLACE, WRITERNAME, WRITERPHONENUMBER, 
CD2.CODE AS BVALUATIONTYPE, BCIFGUESS, BVERIFYDATA1, BVERIFYDATA2, B10AA, B10AB, B10AC, B10AD, B10AE, B10AF, B10AG, B10AOTHERREASON, B10BA, B10BB, B10BC, B10BD, B10BE, B10BOTHERREASON, A11ACOST, A11ACURRENCY, A11AEXCHRATE, A11BCOST, A12COST, A13ACOST, A13BCOST, A13CCOST, A14ACOST, A14BCOST, A14CCOST, A14DCOST, A15COST, A16COST, A17COST, A17ACOST, A17BCOST, A17CCOST, A18COST, A19COST, A20COST, A21COST, A22COST, A23COST, B12COST, B12CURRENCY, B12EXCHRATE, B12KRWCOST, B13ACOST, B13BCOST, B13CCOST, B13DCOST, B13ECOST, B14COST, B15ACOST, B15BCOST, B15CCOST, B15DCOST, B15ECOST, B16COST, B18COST, B18CURRENCY, B18EXCHRATE, B18KRWCOST, BECUSTOMNUMBER, B19ACOST, B19BCOST, B19BRATE, B19BRATEGBN, B19CCOST, B19DCOST, B19ECOST, B19FCOST, B19GCOST, B19HCOST, B20COST, B22COST, B23ACOST, B23BCOST, B23CCOST, B24COST, PROVADDRATE, PROVVALUEDATE, PROVCONTRACTEXPIRYDATE, PROVSAYUA, PROVSAYUB, PROVSAYUC, PROVSAYUD, PROVSAYUE, PROVSAYUF, PROVSAYUG, PROVSAYUH, PROVSAYUI, PROVSAYUJ, PROVSAYUK, PROVSAYUL, PROVSAYUM, PROVSAYULREASON, PROVADDCOST, CIFKRW, SENDFLAG, RECVFLAG, JUBSUDATE, LICENSEDATE, LASTEDITDATETIME, CUSTOMWRITTENLAN, FAX_SEND, NAPSE_SANGHO, NAPSE_SAUP, CHARGEPLACE, CHARGENAME, CHARGETEL, PROVSAYUN, PROVSAYUO, PROVSAYUP, PROVSAYUQ, A7D, 
CD3.CODE AS A7E, A7E_ETC, PONO, PODATE
FROM KCBA.GAKYKNEW A
LEFT JOIN CDSTD CD1 /* 특수관계유형코드*/
ON A.A6B = CD1.CODE3
AND CD1.CLASS = '1090'
AND CD1.CODE3 <> ''
LEFT JOIN CDSTD CD2 /* 과세가격평가방법코드*/
ON A.BVALUATIONTYPE = CD2.CODE3
AND CD2.CLASS = '1110'
AND CD2.CODE3 <> ''
LEFT JOIN CDSTD CD3 /* 가격산출방법코드*/
ON A.A7E = CD3.CODE3
AND CD3.CLASS = '1100'
AND CD3.CODE3 <> '';