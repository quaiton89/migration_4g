/*
1. 속도 개선을 위하여 TRUNCATE TABLE 로 변경합니다. BY MKIM 20160219
*/

/* 송신_관세감면분납용도세율적용신청서 공통사항 */
TRUNCATE TABLE GWNGAMMS;

INSERT INTO GWNGAMMS (
GAMMS_YEAR, GAMMS_JECHL_NO, GAMMS_SINGO_NO, GAMMS_DG, GAMMS_TCANO, GAMMS_SEGWAN, GAMMS_GWA, GAMMS_EXPO_YJ_SEGWAN, GAMMS_EXPO_YJ_DATE, GAMMS_EXPO_NATION_CODE, GAMMS_EXPO_NATION_NAME, GAMMS_SINGO_DATE, GAMMS_SINGOJA_CODE, GAMMS_SINGOJA_SANGHO, GAMMS_SINGOJA_NAME, GAMMS_SINGOJA_JUSO, GAMMS_SINGOJA_TONG, GAMMS_SINGOJA_SAUP, GAMMS_SINGOJA_JONG, GAMMS_SEUNGIN_DATE, GAMMS_DAMDANG_NAME, GAMMS_DAMDANG_CODE, GAMMS_SEND_RESULT, GAMMS_RECV_RESULT, GAMMS_JUBSU_DATE, GAMMS_JUBSU_NO, LOG_TYPE, FAX_SEND
)
SELECT 
GAMMS_YEAR, GAMMS_JECHL_NO, GAMMS_SINGO_NO, GAMMS_DG, GAMMS_TCANO, GAMMS_SEGWAN, GAMMS_GWA, GAMMS_EXPO_YJ_SEGWAN, GAMMS_EXPO_YJ_DATE, GAMMS_EXPO_NATION_CODE, GAMMS_EXPO_NATION_NAME, GAMMS_SINGO_DATE, GAMMS_SINGOJA_CODE, GAMMS_SINGOJA_SANGHO, GAMMS_SINGOJA_NAME, GAMMS_SINGOJA_JUSO, GAMMS_SINGOJA_TONG, GAMMS_SINGOJA_SAUP, GAMMS_SINGOJA_JONG, GAMMS_SEUNGIN_DATE, GAMMS_DAMDANG_NAME, GAMMS_DAMDANG_CODE, GAMMS_SEND_RESULT, GAMMS_RECV_RESULT, GAMMS_JUBSU_DATE, GAMMS_JUBSU_NO, LOG_TYPE, FAX_SEND
FROM KCBA.GWNGAMMS;

/* 송신_관세감면분납용도세율적용신청서 란사항 */
TRUNCATE TABLE GWNGAMLN;

INSERT INTO GWNGAMLN (
GAMLN_YEAR, GAMLN_JECHL_NO, GAMLN_LAN, GAMLN_SAHU, GAMLN_SINCHUNG_GBN, GAMLN_BUNAP_BUHO, GAMLN_HS, GAMLN_PUM, GAMLN_GUKYK, GAMLN_MODEL, GAMLN_MODEL_NO, GAMLN_SU, GAMLN_SU_DANWI, GAMLN_SINGO_AMT, GAMLN_GAM_AMT, GAMLN_JUSO, GAMLN_POST, GAMLN_TEL, GAMLN_YONGDO, GAMLN_SAHU_SEGWAN, GAMLN_BIGO, GAMLN_EXPO_YJ_SEGWAN, GAMLN_EXPO_YJ_DATE, GAMLN_EXPO_NATION_CODE, GAMLN_EXPO_NATION_NAME, GAMLN_SIN_GBN, 
GAMLN_GWANRULEGBN, GAMLN_GWANRULESEQ, GAMLN_GWANRULEHONO, 
GAMLN_YONGDO_GBN
)
SELECT 
GAMLN_YEAR, GAMLN_JECHL_NO, GAMLN_LAN, GAMLN_SAHU, GAMLN_SINCHUNG_GBN, GAMLN_BUNAP_BUHO, GAMLN_HS, GAMLN_PUM, GAMLN_GUKYK, GAMLN_MODEL, GAMLN_MODEL_NO, GAMLN_SU, GAMLN_SU_DANWI, GAMLN_SINGO_AMT, GAMLN_GAM_AMT, GAMLN_JUSO, GAMLN_POST, GAMLN_TEL, GAMLN_YONGDO, GAMLN_SAHU_SEGWAN, GAMLN_BIGO, GAMLN_EXPO_YJ_SEGWAN, GAMLN_EXPO_YJ_DATE, GAMLN_EXPO_NATION_CODE, GAMLN_EXPO_NATION_NAME, GAMLN_SIN_GBN, 
CD2.CODE AS GAMLN_GWANRULEGBN, GAMLN_GWANRULESEQ, GAMLN_GWANRULEHONO, 
CD1.CODE AS GAMLN_YONGDO_GBN
FROM KCBA.GWNGAMLN A
LEFT JOIN CDSTD CD1 /* 관세감면분납용도구분코드 */
ON A.GAMLN_YONGDO_GBN = CD1.CODE3
AND CD1.CLASS = '1160'
AND CD1.CODE3 <> ''
LEFT JOIN CDSTD CD2 /* 감면대상별표코드 */
ON A.GAMLN_GWANRULEGBN = CD2.CODE3
AND CD2.CLASS = '1170'
AND CD2.CODE3 <> '';



