/*
1. 속도 개선을 위하여 TRUNCATE TABLE 로 변경합니다. BY MKIM 20160219
*/


/* 송신_수입(정정)신고서 */
TRUNCATE TABLE IMJUNG1;
TRUNCATE TABLE IMJUNG2;
TRUNCATE TABLE IMJUNG3;
TRUNCATE TABLE IMJUNG2DTL;

/* 송신_수입(정정)신고서 공통사항 */
TRUNCATE TABLE BFIMPO1;

INSERT INTO BFIMPO1 (
IMPO_KEY, IMPO_SEQNO, IMPO_YEAR, IMPO_JECHL_NO, IMPO_CHK_DG, IMPO_TCANO, IMPO_LOCAL_GUBUN, IMPO_SAVE_GBN, IMPO_FILE_NO1, IMPO_FILE_NO2, IMPO_SINGOJA_SANGHO, IMPO_SUIPJA_CODE, IMPO_SUIPJA_SANGHO, IMPO_SUIPJA_MUYK, IMPO_SUIPJA_GUBUN, IMPO_NAPSE_CODE, IMPO_NAPSE_SANGHO, IMPO_NAPSE_NAME, IMPO_NAPSE_POST, IMPO_NAPSE_JUSO, IMPO_NAPSE_TONG, IMPO_NAPSE_SAUP_GUBUN, IMPO_NAPSE_SAUP, IMPO_UPJA_CODE, IMPO_UPJA_SANGHO, IMPO_GONGGUB, IMPO_GONGGUB_SANGHO, IMPO_GONGGUB_BUHO, IMPO_SEGWAN, IMPO_GWA, IMPO_SINGO_NO, IMPO_PLAN, IMPO_SINGO_GUBUN, IMPO_SINGO_DATE, IMPO_GELE_GUBUN, 
IMPO_JONGLU, IMPO_WONSANJI_YN, IMPO_GAKYK_YN, IMPO_GYELJE, IMPO_IPHANG_DATE, IMPO_HANGGU_CODE, IMPO_HANGGU_NAME, IMPO_HANGGU_GUBUN, IMPO_SHIP_NAME, IMPO_MBL_NO, IMPO_UNSU_GIGWAN, IMPO_UNSU_NAME, IMPO_SUNGI_CODE, IMPO_SUNGI_NAME, IMPO_UNSONG_TYPE, IMPO_UNSONG_BOX, IMPO_JUKCHL_CODE, IMPO_JUKCHL_NAME, IMPO_BL_NO, IMPO_BL_GUBUN, IMPO_BANIP_DATE, IMPO_JANGCH_BUHO, IMPO_JANGCH_NAME, IMPO_JANGCH_JANGSO, IMPO_JANGCH_GWA, IMPO_MRN_NO, IMPO_LAN, IMPO_JINGSU_TYPE, IMPO_NAPBU_DATE1, IMPO_NAPBU_DATE2, IMPO_NAPBU_NO, IMPO_DAMDANG_NO, IMPO_DAMDANG_NAME, IMPO_INDO_JOGUN, IMPO_GYELJE_MONEY, IMPO_GYELJE_INPUT, IMPO_USD_EXCH, IMPO_EXCH_YUL, IMPO_INS_YN, IMPO_INS_TOTAL, IMPO_INS_SINGO, IMPO_FRE_MONEY, IMPO_FRE_EXCH, IMPO_FRE, IMPO_FRE_WON, IMPO_INS_INPUT, IMPO_INS_LAST, IMPO_PLUS_YUL_GUBUN, IMPO_PLUS_YUL, IMPO_PLUS_MONEY, IMPO_PLUS_EXCH, IMPO_PLUS, IMPO_PLUS_WON, IMPO_PLUS_TOTAL, IMPO_MINUS_YUL_GUBUN, IMPO_MINUS_YUL, IMPO_MINUS_MONEY, IMPO_MINUS_EXCH, IMPO_MINUS, IMPO_MINUS_WON, IMPO_MINUS_TOTAL, IMPO_CHARGE_MONEY, IMPO_CHARGE_EXCH, IMPO_CHARGE, IMPO_CHARGE_WON, IMPO_POJANG_SU, IMPO_POJANG_DANWI, IMPO_TOTAL_JUNG, IMPO_JUNG_DANWI, IMPO_COST, IMPO_GAMJUNGGA_BF, IMPO_RATE, IMPO_CIF_TOTAL_WON, IMPO_CIF_TOTAL_USD, IMPO_GWAN_TAX, IMPO_TEUK_TAX, IMPO_OIL_TAX, IMPO_JU_TAX, IMPO_NEGUK_TAX, IMPO_EDU_TAX, IMPO_NONG_TAX, IMPO_VAT_GWAPYO, IMPO_GWASE_VAT_GWAPYO, IMPO_MYUNSE_VAT_GWAPYO, IMPO_VAT_TAX, IMPO_GASAN_TAX, IMPO_GITA_TAX, IMPO_TOTAL_TAX, IMPO_TEUKSONG, IMPO_TEUKSONG_NAME, IMPO_CHAMJO_NO, IMPO_GIJE, IMPO_OK_DATE, IMPO_JUBSU_DATE, IMPO_BL_TYPE, IMPO_CALL, IMPO_SEND_GUBUN, IMPO_GASAN_ILSU, IMPO_GASANGUM_MYUNJE, IMPO_SEND_RESULT, IMPO_RECEIVE_RESULT, IMPO_JUNG_CHASU, IMPO_ACCCNV, IMPO_DAMDANGJA, IMPO_JANGCHI_CNT, IMPO_WEBSERVER, IMPO_DAECODE, IMPO_DAESANGHO, IMPO_DAESAUPNO, IMPO_SUIPSAUPNO, IMPO_SUIP_UPTE, IMPO_SUIP_JONGMOK, IMPO_NAPSE_UPTE, IMPO_NAPSE_JONGMOK, LOG_TYPE, EVENT_TYPE, SCAN_LINK, IMPO_BL_SAYU_CODE, IMPO_BL_SAYU, IMPO_MISINGO_TAX, IMPO_MISINGO_TAX_YN, IMPO_SINGOJA_NAME, WEB_SEND, USERNO, FAX_SEND, IMPO_CS, IMPO_INLANDFRE, IMPO_INLANDFRE_EXCH, IMPO_INLANDFRE_MONEY, IMPO_FTA_OBJ, IMPO_RSLTGAKYK_DATE, IMPO_5SMREGNO, IMPO_SINGOJA_TEL, IMPO_SINGOJA_EMAIL, IMPO_NAPSE_TEL, IMPO_NAPSE_EMAIL, IMPO_FORWARDER_CODE, IMPO_FORWARDER_SANGHO, IMPO_SUIPJA_TONG, MAIL_SEND, IMPO_GOLDACCGBN, SMSSEND, USERID, USERNM, ADDDTTIME, EDITDTTIME, IMPO_USESINGBN, IMPO_USESINDT, IMPO_NAPSECOMNO, ATTACHIMAGEYN, PRT_CNT, IMPO_BANCHUL, SENDERNM, IMPO_TEUKCORPID
)
SELECT 
IMPO_KEY, IMPO_SEQNO, IMPO_YEAR, IMPO_JECHL_NO, IMPO_CHK_DG, IMPO_TCANO, IMPO_LOCAL_GUBUN, IMPO_SAVE_GBN, IMPO_FILE_NO1, IMPO_FILE_NO2, IMPO_SINGOJA_SANGHO, IMPO_SUIPJA_CODE, IMPO_SUIPJA_SANGHO, IMPO_SUIPJA_MUYK, IMPO_SUIPJA_GUBUN, IMPO_NAPSE_CODE, IMPO_NAPSE_SANGHO, IMPO_NAPSE_NAME, IMPO_NAPSE_POST, IMPO_NAPSE_JUSO, IMPO_NAPSE_TONG, IMPO_NAPSE_SAUP_GUBUN, IMPO_NAPSE_SAUP, IMPO_UPJA_CODE, IMPO_UPJA_SANGHO, IMPO_GONGGUB, IMPO_GONGGUB_SANGHO, IMPO_GONGGUB_BUHO, IMPO_SEGWAN, IMPO_GWA, IMPO_SINGO_NO, IMPO_PLAN, IMPO_SINGO_GUBUN, IMPO_SINGO_DATE, IMPO_GELE_GUBUN, 
CD1.IMJONG_CODE AS IMPO_JONGLU, IMPO_WONSANJI_YN, IMPO_GAKYK_YN, IMPO_GYELJE, IMPO_IPHANG_DATE, IMPO_HANGGU_CODE, IMPO_HANGGU_NAME, IMPO_HANGGU_GUBUN, IMPO_SHIP_NAME, IMPO_MBL_NO, IMPO_UNSU_GIGWAN, IMPO_UNSU_NAME, IMPO_SUNGI_CODE, IMPO_SUNGI_NAME, IMPO_UNSONG_TYPE, IMPO_UNSONG_BOX, IMPO_JUKCHL_CODE, IMPO_JUKCHL_NAME, IMPO_BL_NO, IMPO_BL_GUBUN, IMPO_BANIP_DATE, IMPO_JANGCH_BUHO, IMPO_JANGCH_NAME, IMPO_JANGCH_JANGSO, IMPO_JANGCH_GWA, IMPO_MRN_NO, IMPO_LAN, IMPO_JINGSU_TYPE, IMPO_NAPBU_DATE1, IMPO_NAPBU_DATE2, IMPO_NAPBU_NO, IMPO_DAMDANG_NO, IMPO_DAMDANG_NAME, IMPO_INDO_JOGUN, IMPO_GYELJE_MONEY, IMPO_GYELJE_INPUT, IMPO_USD_EXCH, IMPO_EXCH_YUL, IMPO_INS_YN, IMPO_INS_TOTAL, IMPO_INS_SINGO, IMPO_FRE_MONEY, IMPO_FRE_EXCH, IMPO_FRE, IMPO_FRE_WON, IMPO_INS_INPUT, IMPO_INS_LAST, IMPO_PLUS_YUL_GUBUN, IMPO_PLUS_YUL, IMPO_PLUS_MONEY, IMPO_PLUS_EXCH, IMPO_PLUS, IMPO_PLUS_WON, IMPO_PLUS_TOTAL, IMPO_MINUS_YUL_GUBUN, IMPO_MINUS_YUL, IMPO_MINUS_MONEY, IMPO_MINUS_EXCH, IMPO_MINUS, IMPO_MINUS_WON, IMPO_MINUS_TOTAL, IMPO_CHARGE_MONEY, IMPO_CHARGE_EXCH, IMPO_CHARGE, IMPO_CHARGE_WON, IMPO_POJANG_SU, IMPO_POJANG_DANWI, IMPO_TOTAL_JUNG, IMPO_JUNG_DANWI, IMPO_COST, IMPO_GAMJUNGGA_BF, IMPO_RATE, IMPO_CIF_TOTAL_WON, IMPO_CIF_TOTAL_USD, IMPO_GWAN_TAX, IMPO_TEUK_TAX, IMPO_OIL_TAX, IMPO_JU_TAX, IMPO_NEGUK_TAX, IMPO_EDU_TAX, IMPO_NONG_TAX, IMPO_VAT_GWAPYO, IMPO_GWASE_VAT_GWAPYO, IMPO_MYUNSE_VAT_GWAPYO, IMPO_VAT_TAX, IMPO_GASAN_TAX, IMPO_GITA_TAX, IMPO_TOTAL_TAX, IMPO_TEUKSONG, IMPO_TEUKSONG_NAME, IMPO_CHAMJO_NO, IMPO_GIJE, IMPO_OK_DATE, IMPO_JUBSU_DATE, IMPO_BL_TYPE, IMPO_CALL, IMPO_SEND_GUBUN, IMPO_GASAN_ILSU, IMPO_GASANGUM_MYUNJE, IMPO_SEND_RESULT, IMPO_RECEIVE_RESULT, IMPO_JUNG_CHASU, IMPO_ACCCNV, IMPO_DAMDANGJA, IMPO_JANGCHI_CNT, IMPO_WEBSERVER, IMPO_DAECODE, IMPO_DAESANGHO, IMPO_DAESAUPNO, IMPO_SUIPSAUPNO, IMPO_SUIP_UPTE, IMPO_SUIP_JONGMOK, IMPO_NAPSE_UPTE, IMPO_NAPSE_JONGMOK, LOG_TYPE, EVENT_TYPE, SCAN_LINK, IMPO_BL_SAYU_CODE, IMPO_BL_SAYU, IMPO_MISINGO_TAX, IMPO_MISINGO_TAX_YN, IMPO_SINGOJA_NAME, WEB_SEND, USERNO, FAX_SEND, IMPO_CS, IMPO_INLANDFRE, IMPO_INLANDFRE_EXCH, IMPO_INLANDFRE_MONEY, IMPO_FTA_OBJ, IMPO_RSLTGAKYK_DATE, IMPO_5SMREGNO, IMPO_SINGOJA_TEL, IMPO_SINGOJA_EMAIL, IMPO_NAPSE_TEL, IMPO_NAPSE_EMAIL, IMPO_FORWARDER_CODE, IMPO_FORWARDER_SANGHO, IMPO_SUIPJA_TONG, MAIL_SEND, IMPO_GOLDACCGBN, SMSSEND, USERID, USERNM, ADDDTTIME, EDITDTTIME, IMPO_USESINGBN, IMPO_USESINDT, IMPO_NAPSECOMNO, ATTACHIMAGEYN, PRT_CNT, IMPO_BANCHUL, SENDERNM, IMPO_TEUKCORPID
FROM KCBA.BFIMPO1 A
LEFT JOIN BIMJONG CD1 /*수입종류코드 */
ON A.IMPO_JONGLU = CD1.CODE3;

/* 송신_수입(정정)신고서 란사항 */
TRUNCATE TABLE BFIMPO2;
INSERT INTO BFIMPO2 (
IMLAN_KEY, IMLAN_SEQNO, IMLAN_JECHL_LAN, IMLAN_HS, IMLAN_WHAN_JEPUM, IMLAN_SEYUL_GUBUN, IMLAN_SEYUL_PRN, IMLAN_POPUM, IMLAN_GURAE_PUM, IMLAN_MODEL_CODE, IMLAN_MODEL, IMLAN_GWAN_GELE, IMLAN_GWAN_HS, IMLAN_GWAN_GUMSA, IMLAN_GWAN_GIJE1, IMLAN_GWAN_GIJE2, IMLAN_GWAN_GIJE3, IMLAN_GWAN_GIJE4, IMLAN_GIJE1, IMLAN_GIJE2, IMLAN_GIJE3, IMLAN_GIJE4, IMLAN_GIJE5, IMLAN_GIJE6, IMLAN_GIJE7, IMLAN_GIJE8, IMLAN_GIJE9, IMLAN_GIJE10, IMLAN_ATTACHI, IMLAN_GUKYK_CNT, IMLAN_YOGUN_CNT, IMLAN_COST, IMLAN_FRE_WON, IMLAN_INS_WON, IMLAN_PLUS_YUL_GUBUN, IMLAN_PLUS_YUL, IMLAN_PLUS_MONEY, IMLAN_PLUS_EXCH, IMLAN_PLUS, IMLAN_PLUS_WON, IMLAN_PLUS_DIV, IMLAN_MINUS_YUL_GUBUN, IMLAN_MINUS_YUL, IMLAN_MINUS_MONEY, IMLAN_MINUS_EXCH, IMLAN_MINUS, IMLAN_MINUS_WON, IMLAN_MINUS_DIV, IMLAN_CHARGE_WON, IMLAN_GWAN_GUBUN, 
IMLAN_GWAN_GAM_GUBUN, IMLAN_GWAN_GAM_BUHO, IMLAN_GWAN_BUNNAP_CNT, IMLAN_GWAN_GYENG_YUL, IMLAN_GWAN_SEYULA, IMLAN_GWAN_SEYULB, IMLAN_GWAN_DANGA, IMLAN_GWAN_TE1, IMLAN_GWAN_TE2, IMLAN_MIN_AMT, IMLAN_TOTAL_MIN, 
IMLAN_NEGUK_GUBUN, IMLAN_NEGUK_CODE, IMLAN_NEGUK_MYUN, IMLAN_NEGUK_SEYUL, IMLAN_NEGUK_JONG, IMLAN_EDU_YN, IMLAN_TEUK_GIJUN1, IMLAN_TEUK_CNT, IMLAN_DOSU, IMLAN_JU_SU, IMLAN_NONG_GUBUN, IMLAN_VAT_GUBUN, IMLAN_VAT_GAM_BUHO, IMLAN_VAT_GYENG_YUL, IMLAN_CIF_WON, IMLAN_CIF_USD, IMLAN_GYENG_GAM, IMLAN_GWANSE_GAM, IMLAN_GWAN_CASE, IMLAN_GWAN_SEYULC, IMLAN_SPECIAL, IMLAN_SAN_GWAN, IMLAN_MYUN_GWAN, IMLAN_GYENG_GWAN, IMLAN_GWAN_TAX, IMLAN_TEUK_GIJUN2, IMLAN_NEGUK_GWAPYO, IMLAN_SAN_NEGUK, IMLAN_MYUN_NEGUK, IMLAN_NEGUK_TAX, IMLAN_EDU_SEYUL, IMLAN_SAN_EDU, IMLAN_MYUN_EDU, IMLAN_EDU_TAX, IMLAN_GWAPYO_NONG1, IMLAN_SEYUL_NONG1, IMLAN_NONG_TAX1, IMLAN_GWAPYO_NONG2, IMLAN_SEYUL_NONG2, IMLAN_NONG_TAX2, IMLAN_GWAPYO_NONG, IMLAN_SEYUL_NONG, IMLAN_NONG_TAX, IMLAN_TOT_GWAPYO, IMLAN_GWAPYO_VAT, IMLAN_MYUN_GWAPYO, IMLAN_SAN_VAT, IMLAN_MYUN_VAT, IMLAN_VAT_TAX, IMLAN_TOTAL_TAX, IMLAN_CALC_GUBUN, IMLAN_CALC_GUEN, IMLAN_JUNG, IMLAN_JUNG_DANWI, IMLAN_SU, IMLAN_SU_DANWI, IMLAN_MULRYANG, IMLAN_MULRYANG_DANWI, IMLAN_WONSANJI_CODE, IMLAN_WONSANJI_NAME, IMLAN_CS, IMLAN_CS_GUMSA1, IMLAN_CS_GUMSA2, IMLAN_ETC, IMLAN_SAHU_GIGWAN1, IMLAN_SAHU_GIGWAN2, IMLAN_SAHU_GIGWAN3, IMLAN_WONSANJI_MARK, IMLAN_WONSANJI_BANG, IMLAN_WONSANJI_TYPE, IMLAN_WONSANJI_NO, IMLAN_WONSANJI_DATE, IMLAN_WONSANJI_CNTRY, IMLAN_WONSANJI_GIGWAN, IMLAN_MODIFY_GBN, IMLAN_WONSANJI_BASE, IMLAN_WONSANJI_ISSUE_LOC, IMLAN_WONSANJI_ISSUE_CLR, IMLAN_WONSANJI_DCSN_BASE, IMLAN_GOODSOFFICEDOCNO, IMLAN_WONSANJI_DIV_YN, IMLAN_WONSANJI_TOT_QTY, IMLAN_WONSANJI_USE_QTY, IMLAN_WONSANJI_TOT_WGHT, IMLAN_WONSANJI_USE_WGHT, IMLAN_FTA_OBJ, IMLAN_GOODSCODE, IMLAN_SPECCODE, IMLAN_STDGOODSCODE, IMLAN_NOTYOGCNT, IMLAN_OEXEMPTSAYUCD, IMLAN_JUMYUNCD, IMLAN_JEPUMJAJAEGBN, IMLAN_JEPUMLANNO, IMLAN_CHECKNEEDGBN
)
SELECT 
IMLAN_KEY, IMLAN_SEQNO, IMLAN_JECHL_LAN, IMLAN_HS, IMLAN_WHAN_JEPUM, IMLAN_SEYUL_GUBUN, IMLAN_SEYUL_PRN, IMLAN_POPUM, IMLAN_GURAE_PUM, IMLAN_MODEL_CODE, IMLAN_MODEL, IMLAN_GWAN_GELE, IMLAN_GWAN_HS, IMLAN_GWAN_GUMSA, IMLAN_GWAN_GIJE1, IMLAN_GWAN_GIJE2, IMLAN_GWAN_GIJE3, IMLAN_GWAN_GIJE4, IMLAN_GIJE1, IMLAN_GIJE2, IMLAN_GIJE3, IMLAN_GIJE4, IMLAN_GIJE5, IMLAN_GIJE6, IMLAN_GIJE7, IMLAN_GIJE8, IMLAN_GIJE9, IMLAN_GIJE10, IMLAN_ATTACHI, IMLAN_GUKYK_CNT, IMLAN_YOGUN_CNT, IMLAN_COST, IMLAN_FRE_WON, IMLAN_INS_WON, IMLAN_PLUS_YUL_GUBUN, IMLAN_PLUS_YUL, IMLAN_PLUS_MONEY, IMLAN_PLUS_EXCH, IMLAN_PLUS, IMLAN_PLUS_WON, IMLAN_PLUS_DIV, IMLAN_MINUS_YUL_GUBUN, IMLAN_MINUS_YUL, IMLAN_MINUS_MONEY, IMLAN_MINUS_EXCH, IMLAN_MINUS, IMLAN_MINUS_WON, IMLAN_MINUS_DIV, IMLAN_CHARGE_WON, IMLAN_GWAN_GUBUN, 
IMLAN_GWAN_GAM_GUBUN, IMLAN_GWAN_GAM_BUHO, IMLAN_GWAN_BUNNAP_CNT, IMLAN_GWAN_GYENG_YUL, IMLAN_GWAN_SEYULA, IMLAN_GWAN_SEYULB, IMLAN_GWAN_DANGA, IMLAN_GWAN_TE1, IMLAN_GWAN_TE2, IMLAN_MIN_AMT, IMLAN_TOTAL_MIN, 
CASE WHEN IMLAN_NEGUK_GUBUN = '0' THEN IMLAN_NEGUK_GUBUN ELSE CD1.NEGUBUN_CODE END AS IMLAN_NEGUK_GUBUN, IMLAN_NEGUK_CODE, IMLAN_NEGUK_MYUN, IMLAN_NEGUK_SEYUL, IMLAN_NEGUK_JONG, IMLAN_EDU_YN, IMLAN_TEUK_GIJUN1, IMLAN_TEUK_CNT, IMLAN_DOSU, IMLAN_JU_SU, IMLAN_NONG_GUBUN, IMLAN_VAT_GUBUN, IMLAN_VAT_GAM_BUHO, IMLAN_VAT_GYENG_YUL, IMLAN_CIF_WON, IMLAN_CIF_USD, IMLAN_GYENG_GAM, IMLAN_GWANSE_GAM, IMLAN_GWAN_CASE, IMLAN_GWAN_SEYULC, IMLAN_SPECIAL, IMLAN_SAN_GWAN, IMLAN_MYUN_GWAN, IMLAN_GYENG_GWAN, IMLAN_GWAN_TAX, IMLAN_TEUK_GIJUN2, IMLAN_NEGUK_GWAPYO, IMLAN_SAN_NEGUK, IMLAN_MYUN_NEGUK, IMLAN_NEGUK_TAX, IMLAN_EDU_SEYUL, IMLAN_SAN_EDU, IMLAN_MYUN_EDU, IMLAN_EDU_TAX, IMLAN_GWAPYO_NONG1, IMLAN_SEYUL_NONG1, IMLAN_NONG_TAX1, IMLAN_GWAPYO_NONG2, IMLAN_SEYUL_NONG2, IMLAN_NONG_TAX2, IMLAN_GWAPYO_NONG, IMLAN_SEYUL_NONG, IMLAN_NONG_TAX, IMLAN_TOT_GWAPYO, IMLAN_GWAPYO_VAT, IMLAN_MYUN_GWAPYO, IMLAN_SAN_VAT, IMLAN_MYUN_VAT, IMLAN_VAT_TAX, IMLAN_TOTAL_TAX, IMLAN_CALC_GUBUN, IMLAN_CALC_GUEN, IMLAN_JUNG, IMLAN_JUNG_DANWI, IMLAN_SU, IMLAN_SU_DANWI, IMLAN_MULRYANG, IMLAN_MULRYANG_DANWI, IMLAN_WONSANJI_CODE, IMLAN_WONSANJI_NAME, IMLAN_CS, IMLAN_CS_GUMSA1, IMLAN_CS_GUMSA2, IMLAN_ETC, IMLAN_SAHU_GIGWAN1, IMLAN_SAHU_GIGWAN2, IMLAN_SAHU_GIGWAN3, IMLAN_WONSANJI_MARK, IMLAN_WONSANJI_BANG, IMLAN_WONSANJI_TYPE, IMLAN_WONSANJI_NO, IMLAN_WONSANJI_DATE, IMLAN_WONSANJI_CNTRY, IMLAN_WONSANJI_GIGWAN, 
'' AS IMLAN_MODIFY_GBN, IMLAN_WONSANJI_BASE, IMLAN_WONSANJI_ISSUE_LOC, IMLAN_WONSANJI_ISSUE_CLR, IMLAN_WONSANJI_DCSN_BASE, IMLAN_GOODSOFFICEDOCNO, IMLAN_WONSANJI_DIV_YN, IMLAN_WONSANJI_TOT_QTY, IMLAN_WONSANJI_USE_QTY, IMLAN_WONSANJI_TOT_WGHT, IMLAN_WONSANJI_USE_WGHT, IMLAN_FTA_OBJ, IMLAN_GOODSCODE, IMLAN_SPECCODE, IMLAN_STDGOODSCODE, IMLAN_NOTYOGCNT, IMLAN_OEXEMPTSAYUCD, IMLAN_JUMYUNCD, IMLAN_JEPUMJAJAEGBN, IMLAN_JEPUMLANNO, IMLAN_CHECKNEEDGBN
FROM KCBA.BFIMPO2 A
LEFT JOIN BNEGUBUN CD1  /* 내국세구분코드 */
ON A.IMLAN_NEGUK_GUBUN = CD1.CODE3;

/* 송신_수입(정정)신고서 모델규격 */
TRUNCATE TABLE BFIMPO3;
INSERT INTO BFIMPO3 (
IMPUM_KEY, IMPUM_SEQNO, IMPUM_LAN, IMPUM_HEANG, IMPUM_JAJAE_CODE, IMPUM_GUKYK1, IMPUM_GUKYK2, IMPUM_GUKYK3, IMPUM_SUNGBUN1, IMPUM_SUNGBUN2, IMPUM_SUNGBUN3, IMPUM_SU, IMPUM_SU_DANWI, IMPUM_DANGA, IMPUM_AMT, C31, IMPUM_IVNO, IMPUM_CONTACTNO
)
SELECT 
IMPUM_KEY, IMPUM_SEQNO, IMPUM_LAN, IMPUM_HEANG, IMPUM_JAJAE_CODE, IMPUM_GUKYK1, IMPUM_GUKYK2, IMPUM_GUKYK3, IMPUM_SUNGBUN1, IMPUM_SUNGBUN2, IMPUM_SUNGBUN3, IMPUM_SU, IMPUM_SU_DANWI, IMPUM_DANGA, IMPUM_AMT, C31, IMPUM_IVNO, IMPUM_CONTACTNO
FROM KCBA.BFIMPO3;

/* 송신_수입(정정)신고서 요건정보 */
TRUNCATE TABLE BFIMPO4;
INSERT INTO BFIMPO4 (
SUIPYOGUN_KEY, SUIPYOGUN_SEQNO, SUIPYOGUN_LAN, SUIPYOGUN_GUKYKNO, SUIPYOGUN_HEANG, 
SUIPYOGUN_GUBUN, SUIPYOGUN_GUM_GUBUN, SUIPYOGUN_GUM_GIGWAN, SUIPYOGUN_NO, SUIPYOGUN_DATE, SUIPYOGUN_BUB_CODE, SUIPYOGUN_MULRYANG, SUIPYOGUN_MULRYANG_DANWI, SUIPYOGUN_TEXT_NAME, SUIPYOGUN_USAGECD, SUIPYOGUN_GIGWANPUMCD
)
SELECT 
SUIPYOGUN_KEY, SUIPYOGUN_SEQNO, SUIPYOGUN_LAN, '01', SUIPYOGUN_HEANG, 
CASE SUBSTRING(SUIPYOGUN_GUBUN,1,1) WHEN '8' THEN '2' ELSE '1' END AS SUIPYOGUN_GUBUN, SUIPYOGUN_GUM_GUBUN, SUIPYOGUN_GUM_GIGWAN, SUIPYOGUN_NO, SUIPYOGUN_DATE, SUIPYOGUN_BUB_CODE, SUIPYOGUN_MULRYANG, SUIPYOGUN_MULRYANG_DANWI, SUIPYOGUN_TEXT_NAME, SUIPYOGUN_USAGECD, SUIPYOGUN_GIGWANPUMCD
FROM KCBA.BFIMPO4;

/* 송신_수입(정정)신고서  재수출내역 */
TRUNCATE TABLE BFIMPO5;
INSERT INTO BFIMPO5 (
IMEXNO_KEY, IMEXNO_SEQNO, IMEXNO_LAN, IMEXNO_CNT, IMEXNO_SINGO_NO, IMEXNO_SINGO_LAN, IMEXNO_SU, IMEXNO_SU_DANWI, IMEXNO_JUNG, IMEXNO_JUNG_DANWI, IMEXNO_SINGOHAENG, IMEXNO_USESU, IMEXNO_USESUUNT, IMEXNO_RESTSU
)
SELECT 
IMEXNO_KEY, IMEXNO_SEQNO, IMEXNO_LAN, IMEXNO_CNT, IMEXNO_SINGO_NO, IMEXNO_SINGO_LAN, IMEXNO_SU, IMEXNO_SU_DANWI, IMEXNO_JUNG, IMEXNO_JUNG_DANWI, IMEXNO_SINGOHAENG, IMEXNO_USESU, IMEXNO_USESUUNT, IMEXNO_RESTSU
FROM KCBA.BFIMPO5;

/* 송신_수입(정정)신고서 요건비대상정보 */
TRUNCATE TABLE BFIMNOTYOG;
INSERT INTO BFIMNOTYOG (
IMPO_KEY, IMPO_SEQNO, LAN, SEQ, LAWCD, NOTYOGSAYUCD, NOTYOGSAYUETC
)
SELECT 
IMPO_KEY, IMPO_SEQNO, LAN, SEQ, LAWCD, NOTYOGSAYUCD, NOTYOGSAYUETC
FROM KCBA.BFIMNOTYOG;

/* 송신_수입(정정)신고서 안분기준 */
TRUNCATE TABLE BFIMPO1DTL;
INSERT INTO BFIMPO1DTL (
IMPO_KEY, IMPO_SEQNO, IMPO_CONTENT
)
SELECT 
IMPO_KEY, IMPO_SEQNO, IMPO_CONTENT
FROM KCBA.BFIMPO1DTL;
