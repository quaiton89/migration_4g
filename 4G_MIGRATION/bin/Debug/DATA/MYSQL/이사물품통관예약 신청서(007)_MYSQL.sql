/*
1. 속도 개선을 위하여 TRUNCATE TABLE 로 변경합니다. BY MKIM 20160219
*/

/* 송신_이사물품통관예약 */
TRUNCATE TABLE MOVINGRSV;
INSERT INTO MOVINGRSV (
MR_KEY, MR_TCANO, MR_YEAR, MR_JECHLNO, MR_ID, MR_NAME, MR_SINGONAME, MR_SINGODATE, MR_TEL, MR_EMAIL, MR_BLNO, MR_CNO, MR_WAREHOUSE, MR_WISHDATE, MR_CARCODE, MR_SHIPCODE, MR_AIRPLANECODE, MR_CARRIER, MR_CARRIERTEL, MR_FIXEDDATE, MR_SPECIALADD, MR_BRAND, MR_MODEL, MR_YEARDATE, MR_CARMEASURE, MR_FIRSTDATE, MR_CARNO, MR_IMPREDATE, 
MR_LOCATION, MR_SENDRESULT, MR_RECVRESULT, MR_JUBSUDATE, MR_LICENSEDATE, MR_FAXSEND
)
SELECT 
MR_KEY, MR_TCANO, MR_YEAR, MR_JECHLNO, MR_ID, MR_NAME, MR_SINGONAME, MR_SINGODATE, MR_TEL, MR_EMAIL, MR_BLNO, MR_CNO, MR_WAREHOUSE, MR_WISHDATE, MR_CARCODE, MR_SHIPCODE, MR_AIRPLANECODE, MR_CARRIER, MR_CARRIERTEL, MR_FIXEDDATE, MR_SPECIALADD, MR_BRAND, MR_MODEL, MR_YEARDATE, MR_CARMEASURE, MR_FIRSTDATE, MR_CARNO, MR_IMPREDATE, 
CD1.CODE AS MR_LOCATION, MR_SENDRESULT, MR_RECVRESULT, MR_JUBSUDATE, MR_LICENSEDATE, MR_FAXSEND
FROM KCBA.MOVINGRSV A
LEFT JOIN CDSTD CD1 /* 이사물품선적지 */
ON A.MR_LOCATION = CD1.CODE3
AND CD1.CLASS = '1450'
AND CD1.CODE3 <> '';
